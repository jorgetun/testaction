

[/templates/CORPORATIVOS/OID/GW_TEMPLATE]

AdminInterface=
ClassName=com.hp.siu.adminagent.procmgr.SessionServerProcess
Description=Process SAML 2.0 and OID request to forward to SSO_CORP solutions backends for corporate users
JDBCConnectionPoolService=PoolServiceNode
SNMESchemaLoader=SnmeLoader


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors]

ClassName=com.hp.siu.serverutils.ConnectorManager
ConnectorNames=OIDServer
ConnectorNames=OIDClient
ConnectorNames=SAMLClient
ConnectorNames=Schedulers
ConnectorNames=NMERPCSMConnector


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/NMERPCSMConnector]

ClassName=com.hp.usage.nme.rpc.client.NMERPCClientAdapter
Connection=ConnectionConfigParameters
Managed=true
MaxMessageSize=40000
MessageTypes=MessageSesReq
Name=SessionManager
Routers=SMServerPrimary
Routers=SMServerSecondary


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/NMERPCSMConnector/ConnectionConfigParameters]

ClassName=com.hp.usage.nme.rpc.client.NMERPCClientConnection
ConnectionInactiveTime=0
MaxAllowedRequestTimeouts=20000
MaxPendingRequests=30000
MaxResponseQueueSize=30000
ReconnectDelay=500
ResponseTimeout=2000


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/NMERPCSMConnector/MessageSesReq]

ClassName=com.hp.usage.nme.rpc.codec.NMERPCMessageType
RequestNMEType=SSO_CORP:SessionRequest
ResponseNMEType=SSO_CORP:SessionResponse
RuleChain=010.RequestSession
SupportStructuredNME=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/NMERPCSMConnector/SMServerPrimary]

ClassName=com.hp.usage.framework.connector.router.StaticRouter
Destinations=${CONNECTOR_NMERPC_SM_PEERADDR_PRIMARY}


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/NMERPCSMConnector/SMServerSecondary]

ClassName=com.hp.usage.framework.connector.router.StaticRouter
Destinations=${CONNECTOR_NMERPC_SM_PEERADDR_SECONDARY}


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/NMERPCSMConnector/Transport]

ClassName=com.hp.usage.transport.tcp.TCPTransport
PortNumber=${CONNECTOR_NMERPC_SM_PORTNUMBER}


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDClient]

ClassName=com.hp.usage.http.client.HttpClientConnector
RequestAttribute=GW_OperationAttrString
Requests=Authentication
Requests=Token
Requests=Revoke


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDClient/Authentication]

ClassName=com.hp.usage.json.JsonHttpRequest
CreateEmptyParameters=false
EncodeAttribute=requestOID
HttpMethod=POST
RequestAttributeMap=response_type,AMX_AM_GW_RESPONSE_TYPE_String
RequestAttributeMap=client_id,AMX_GW_CLIENTID
RequestAttributeMap=scope,AMX_AM_GW_SCOPE_String
RequestAttributeMap=redirect_uri,AMX_GW_REDIRECT_URI_String
RequestAttributeMap=state,AMX_GW_STATE
RequestAttributeMap=nonce,AMX_GW_NONCE
RequestAttributeMap=display,AMX_AM_GW_DISPLAY_String
RequestAttributeMap=prompt,AMX_AM_GW_PROMPT_String
RequestAttributeMap=max_age,AMX_AM_GW_MAX_AGE_String
RequestAttributeMap=ui_locales,AMX_AM_GW_UI_LOCALES_String
RequestAttributeMap=claims_locales,AMX_AM_GW_CLAIMS_LOCALES_String
RequestAttributeMap=id_token_hint,AMX_AM_GW_ID_TOKEN_HINT_String
RequestAttributeMap=login_hint,AMX_AM_GW_LOGIN_HINT_String
RequestAttributeMap=acr_values,AMX_AM_GW_ACR_VALUES_String
RequestAttributeMap=dtbs,AMX_AM_GW_DTBS_String
RequestAttributeMap=client_issuer,AMX_GW_CLIENT_ID_ISSUER
RequestHeaderMap=msisdn,AMX_AM_GW_MSISDNString
RequestHeaderMap=imei,AMX_AM_GW_IMEI_String
RequestHeaderMap=imsi,AMX_AM_GW_IMSI_String
RequestHeaderMap=username,AMX_AM_GW_USERNAME_String
RequestHeaderMap=pin,AMX_AM_GW_PIN_String
RequestHeaderMap=password,AMX_AM_GW_PWD_String
RequestHeaderMap=otp,AMX_AM_GW_OTP_String
RequestHeaderMap=DEV-msisdn,AMX_AM_GW_DEV_MSISDN_String
RequestHeaderMap=DEV-imei,AMX_AM_GW_DEV_IMEI_String
RequestHeaderMap=DEV-imsi,AMX_AM_GW_DEV_IMSI_String
RequestHeaderMap=DEV-os,AMX_AM_GW_DEV_OS_String
RequestHeaderMap=charset,AMX_AM_GW_CharsetString,"UTF-8"
RequestNMENamespace=SSO_CORP
RequestRootElement=requestOID
RequestXSDFile=${CONNECTOR_TPCCLIENT_OID_JSONRESPONSE_XSDFILE}
ResourceLocation=authorize
ResponseHandlers=AuthResponseHandler
ResponseHeaderMap=RequestID,GW_RequestIdString
ResponseHeaderMap=Location,AMX_GW_LocationRedirect
ResponseHeaderMap=code,AMX_GW_CODE
ResponseHeaderMap=error,GW_ErrorString
ResponseHeaderMap=error_description,GW_ErrorDescriptionString
ResultCodeAttribute=GW_ClientResultCodeString
ResultStatusAttribute=GW_ClientResultStatusString
RootNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDClient/Authentication/AuthResponseHandler]

ClassName=DelimitedTextResponseHandler
ResponseAttributeMap=code,AMX_GW_CODE
ResponseAttributeMap=state,GW_OutStateString
ResponseAttributeMap=error,GW_ErrorString
ResponseAttributeMap=error_description,GW_ErrorDescriptionString
ResponseAttributeMap=error_uri,GW_ErrorURIString
ResponseAttributeMap=nonce,AMX_GW_NONCE
ResponseParameterSeparators=&


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDClient/EndPoints]

ClassName=com.hp.usage.connector.PrimarySecondaryEndPointSelector
EndPoints=Primary
EndPoints=Secondary
FailedEndPointRetryInterval=${CONNECTOR_TPCCLIENT_ENDPOINT_FAILENDPOINTRETRYINTERVAL}


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDClient/EndPoints/Primary]

ClassName=com.hp.usage.http.client.HttpEndPoint
ConnectionTimeout=${CONNECTOR_TPCCLIENT_OID_ENDPOINT_CONNECTIONTIMEOUT}
KeyStoreFile=${ENV_TPCSERVER_KEYSTOREFILE}
KeyStorePassword=changeit
KeyStoreType=JKS
MaxConnections=${CONNECTOR_TPCCLIENT_OID_ENDPOINT_NUMCONNECTIONS}
RemoteHostURL=${CONNECTOR_TPCCLIENT_OID_ENDPOINT_REMOTEHOSTURL_1}
SocketTimeout=${CONNECTOR_TPCCLIENT_OID_ENDPOINT_SOCKETTIMEOUT}


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDClient/EndPoints/Secondary]

ClassName=com.hp.usage.http.client.HttpEndPoint
ConnectionTimeout=${CONNECTOR_TPCCLIENT_OID_ENDPOINT_CONNECTIONTIMEOUT}
KeyStoreFile=${ENV_TPCSERVER_KEYSTOREFILE}
KeyStorePassword=changeit
KeyStoreType=JKS
MaxConnections=${CONNECTOR_TPCCLIENT_OID_ENDPOINT_NUMCONNECTIONS}
RemoteHostURL=${CONNECTOR_TPCCLIENT_OID_ENDPOINT_REMOTEHOSTURL_2}
SocketTimeout=${CONNECTOR_TPCCLIENT_OID_ENDPOINT_SOCKETTIMEOUT}


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDClient/Revoke]

ClassName=com.hp.usage.json.JsonHttpRequest
EncodeAttribute=requestOID
HttpMethod=POST
RequestAttributeMap=Token_type,AMX_GW_TOKEN_TYPE
RequestHeaderMap=content-type,AMX_GW_ContentTypeString
RequestHeaderMap=token,AMX_GW_ACCESS_TOKEN
RequestNMENamespace=SSO_CORP
RequestRootElement=requestOID
RequestXSDFile=${CONNECTOR_TPCCLIENT_OID_JSONRESPONSE_XSDFILE}
ResourceLocation=revoke
ResponseHandlers=RevokeResponseHandler
ResponseHeaderMap=Connection,AMX_GW_ConnectionString
ResultCodeAttribute=GW_ClientResultCodeString
ResultStatusAttribute=GW_ClientResultStatusString
RootNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDClient/Revoke/RevokeResponseHandler]

ClassName=com.hp.usage.json.com.hp.usage.json.JsonResponseHandler
ResponseNMENamespace=SSO_CORP
ResponseRootElement=responseRevoke
ResponseXSDFile=${CONNECTOR_TPCCLIENT_OID_JSONRESPONSE_XSDFILE}
VirtualRoot=responseRevoke


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDClient/Token]

ClassName=com.hp.usage.json.JsonHttpRequest
CreateEmptyParameters=false
EncodeAttribute=requestOID
HttpMethod=POST
RequestAttributeMap=grant_type,AMX_GW_GRANT_TYPE_String
RequestAttributeMap=code,AMX_GW_CODE
RequestAttributeMap=redirect_uri,AMX_GW_REDIRECT_URI_String
RequestAttributeMap=client_credential,AMX_GW_CLIENT_CREDENTIAL_String
RequestAttributeMap=refresh_token,AMX_GW_REFRESH_TOKEN
RequestAttributeMap=scope,AMX_AM_GW_SCOPE_String
RequestAttributeMap=client_id,AMX_GW_CLIENTID
RequestHeaderMap=content-type,GW_ContentTypeString
RequestNMENamespace=SSO_CORP
RequestRootElement=requestOID
RequestXSDFile=${CONNECTOR_TPCCLIENT_OID_JSONRESPONSE_XSDFILE}
ResourceLocation=token
ResponseHandlers=TokenResponseHandler
ResponseHeaderMap=RequestID,GW_RequestIdString
ResponseHeaderMap=Location,AMX_GW_LocationRedirect
ResponseHeaderMap=code,AMX_GW_CODE
ResponseHeaderMap=error,GW_ErrorString
ResponseHeaderMap=error_description,GW_ErrorDescriptionString
ResponseHeaderMap=content-type,GW_ContentTypeString
ResponseHeaderMap=token_type,GW_OutTokenTypeString,null
ResultCodeAttribute=GW_ClientResultCodeString
ResultStatusAttribute=GW_ClientResultStatusString
RootNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDClient/Token/TokenResponseHandler]

ClassName=com.hp.usage.json.JsonResponseHandler
ResponseNMENamespace=SSO_CORP
ResponseRootElement=responseToken
ResponseXSDFile=${CONNECTOR_TPCCLIENT_OID_JSONRESPONSE_XSDFILE}
VirtualRoot=responseToken


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDClient/UserInfo]

ClassName=com.hp.usage.json.JsonHttpRequest
EncodeAttribute=requestOID
HttpMethod=POST
RequestHeaderMap=token,AMX_GW_ACCESS_TOKEN
RequestHeaderMap=content-type,GW_ContentTypeString
RequestNMENamespace=SSO_CORP
RequestRootElement=requestOID
RequestXSDFile=${CONNECTOR_TPCCLIENT_OID_JSONRESPONSE_XSDFILE}
ResourceLocation=userinfo
ResponseHandlers=UserInfoResponseHandler
ResponseHeaderMap=Connection,AMX_GW_ConnectionString
ResultCodeAttribute=GW_ClientResultCodeString
ResultStatusAttribute=GW_ClientResultStatusString
RootNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDClient/UserInfo/UserInfoResponseHandler]

ClassName=com.hp.usage.json.com.hp.usage.json.JsonResponseHandler
ResponseNMENamespace=SSO_CORP
ResponseRootElement=responseUserInfo
ResponseXSDFile=${CONNECTOR_TPCCLIENT_OID_JSONRESPONSE_XSDFILE}
VirtualRoot=responseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer]

ClassName=com.hp.usage.connector.TCPConnector
ClientAuth=false
Host=${CONNECTOR_TPCSERVER_OID_HOST}
KeyStoreFile=${ENV_TPCSERVER_KEYSTOREFILE}
KeyStorePassword=changeit
KeyStoreType=JKS
OperationAttribute=RequestType
Operations=Response
Port=${CONNECTOR_TPCSERVER_OID_PORT}


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer/Protocol]

ClassName=com.hp.usage.http.HttpProtocol
ErrorCodeAttribute=AMX_GW_HttpErrorCode
ErrorMessageAttribute=AMX_GW_HttpErrorMesssage
ErrorRuleChainName=800.ErrorHttpProtocol
Servers=Authorize
Servers=Token
Servers=Userinfo
Servers=Revoke


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer/Protocol/Authorize]

ClassName=com.hp.usage.soap.TextContextProvider
ClientAddressAttribute=AMX_GW_DeviceIpAddressString
ClientPortAttribute=AMX_GW_DestinationPortInteger
ContextIdentifier=authorize
ErrorMessageAttribute=AMX_GW_ErrorContextMessage
ErrorNameAttribute=AMX_GW_ErrorContextName
ErrorRuleChain=810.ErrorHttpContext
RequestAttributeMap=client_id,AMX_GW_CLIENTID
RequestAttributeMap=response_type,AMX_AM_GW_RESPONSE_TYPE_String
RequestAttributeMap=redirect_uri,AMX_GW_REDIRECT_URI_String
RequestAttributeMap=scope,AMX_AM_GW_SCOPE_String
RequestAttributeMap=state,AMX_GW_STATE
RequestAttributeMap=acr_values,AMX_AM_GW_ACR_VALUES_String
RequestAttributeMap=nonce,AMX_GW_NONCE
RequestAttributeMap=client_issuer,AMX_GW_CLIENT_ID_ISSUER
RequestAttributeMap=charset,AMX_GW_CharsetString,"UTF-8"
RequestHeaderMap=username,AMX_AM_GW_USERNAME_String
RequestHeaderMap=password,AMX_AM_GW_PWD_String
RuleChainName=000.AuthnOIDRequest
RuleChainTimeout=3000
_ResponseStatusAttribute=AMX_GW_HttpStatusInteger


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer/Protocol/Authorize/AuthnResponseHandler]

ClassName=com.hp.usage.soap.DelimitedTextResponseGenerator
ContentType=text/plain
ResponseAttributeMap=code,AMX_GW_CODE
ResponseAttributeMap=state,GW_OutStateString
ResponseAttributeMap=error,GW_ErrorString
ResponseAttributeMap=error_description,GW_ErrorDescriptionString
ResponseAttributeMap=error_uri,GW_ErrorURIString
ResponseAttributeMap=nonce,AMX_GW_NONCE
ResponseParameterSeparator=&


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer/Protocol/Revoke]

ClassName=com.hp.usage.soap.TextContextProvider
ClientAddressAttribute=AMX_GW_DeviceIpAddressString
ClientPortAttribute=AMX_GW_DestinationPortInteger
ContextIdentifier=revoke
ErrorMessageAttribute=AMX_GW_ErrorContextMessage
ErrorNameAttribute=AMX_GW_ErrorContextName
ErrorRuleChain=810.ErrorHttpContext
MaintainSessions=false
RequestAttributeMap=Client_issuer,AMX_GW_CLIENT_ID_ISSUER
RequestAttributeMap=Token_type,AMX_GW_TOKEN_TYPE
RequestHeaderMap=TokenID,AMX_GW_TOKENID
RequestHeaderMap=content-type,AMX_GW_ContentTypeString
RequestMethodAttribute=AMX_GW_HTTPMethodString
ResponseStatusAttribute=AMX_GW_HttpStatusInteger
RuleChainName=300.RevokeRequest
RuleChainTimeout=3000


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer/Protocol/SendResponseAfterRuleChain]

ClassName=com.hp.siu.collector.rules.ConditionCheck
Conditions=Sender,=,now


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer/Protocol/Token]

ClassName=com.hp.usage.soap.TextContextProvider
ClientAddressAttribute=AMX_GW_DeviceIpAddressString
ClientPortAttribute=AMX_GW_DestinationPortInteger
ContextIdentifier=token
ErrorMessageAttribute=AMX_GW_ErrorContextMessage
ErrorNameAttribute=AMX_GW_ErrorContextName
ErrorRuleChain=810.ErrorHttpContext
MaintainSessions=false
RequestAttributeMap=scope,AMX_AM_GW_SCOPE_String
RequestAttributeMap=code,AMX_GW_CODE
RequestAttributeMap=client_id,AMX_GW_CLIENTID
RequestAttributeMap=client_credential,AMX_GW_CLIENT_CREDENTIAL_String
RequestAttributeMap=redirect_uri,AMX_GW_REDIRECT_URI_String
RequestAttributeMap=grant_type,AMX_GW_GRANT_TYPE_String
RequestAttributeMap=refresh_token,AMX_GW_REFRESH_TOKEN_String
RequestMethodAttribute=AMX_GW_HTTPMethodString
ResponseStatusAttribute=AMX_GW_HttpStatusInteger
RuleChainName=103.GoToFlowToken
RuleChainTimeout=3000


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer/Protocol/Userinfo]

ClassName=com.hp.usage.soap.TextContextProvider
ClientAddressAttribute=AMX_GW_DeviceIpAddressString
ClientPortAttribute=AMX_GW_DestinationPortInteger
ContextIdentifier=userinfo
ErrorMessageAttribute=AMX_GW_ErrorContextMessage
ErrorNameAttribute=AMX_GW_ErrorContextName
ErrorRuleChain=810.ErrorHttpContext
MaintainSessions=false
RequestHeaderMap=tokenID,AMX_GW_TOKENID
RequestHeaderMap=client_issuer,AMX_GW_CLIENT_ID_ISSUER
RequestMethodAttribute=AMX_GW_HTTPMethodString
ResponseStatusAttribute=AMX_GW_HttpStatusInteger
RuleChainName=000.UserInfoRequest
RuleChainTimeout=3000


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer/Response]

ClassName=com.hp.usage.http.HttpResponse
DestinationHost=%AMX_GW_DeviceIpAddressString%
DestinationPort=%AMX_GW_DestinationPortInteger%
ResponseHandlerAttribute=AMX_AM_GW_ResponseHandlerString
ResponseHandlers=AuthnResponseHandler
ResponseHandlers=TokenResponseHandler
ResponseHandlers=UserInfoResponseHandler
ResponseHandlers=RevokeResponseHandler
ResponseHeaderMap=Location,AMX_GW_LocationRedirect
ResponseStatusAttribute=AMX_GW_HttpStatusInteger


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer/Response/AuthnResponseHandler]

ClassName=com.hp.usage.soap.DelimitedTextResponseGenerator
ContentType=text/plain
ResponseAttributeMap=code,AMX_GW_CODE
ResponseAttributeMap=state,GW_OutStateString
ResponseAttributeMap=error,GW_ErrorString
ResponseAttributeMap=error_description,GW_ErrorDescriptionString
ResponseAttributeMap=error_uri,GW_ErrorURIString
ResponseAttributeMap=nonce,AMX_GW_NONCE
ResponseParameterSeparator=&


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer/Response/RevokeResponseHandler]

ClassName=com.hp.usage.json.JsonResponseGenerator
ResponseNMENamespace=SSO_CORP
ResponseRootElement=responseRevoke
ResponseXSDFile=${CONNECTOR_TPCCLIENT_OID_JSONRESPONSE_XSDFILE}
VirtualRoot=responseRevoke


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer/Response/TokenResponseHandler]

ClassName=com.hp.usage.json.JsonResponseGenerator
EncodeAttribute=responseToken
ResponseNMENamespace=SSO_CORP
ResponseRootElement=responseToken
ResponseXSDFile=${CONNECTOR_TPCCLIENT_OID_JSONRESPONSE_XSDFILE}
RootNMEType=SSO_CORP:Body
VirtualRoot=responseToken


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/OIDServer/Response/UserInfoResponseHandler]

ClassName=com.hp.usage.json.JsonResponseGenerator
ResponseNMENamespace=SSO_CORP
ResponseRootElement=responseUserInfo
ResponseXSDFile=${CONNECTOR_TPCCLIENT_OID_JSONRESPONSE_XSDFILE}
VirtualRoot=responseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/SAMLClient]

ClassName=com.hp.usage.http.client.HttpClientConnector
RequestAttribute=GW_OperationAttrString
Requests=Authentication
Requests=Logout


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/SAMLClient/Authentication]

ClassName=com.hp.usage.http.client.PlainHttpRequest
CreateEmptyParameters=false
HttpMethod=POST
RequestAttributeMap=SAMLRequest,GW_SAMLRequestString
RequestAttributeMap=RelayState,AMX_GW_SAML_RelayStateString
RequestAttributeMap=LoginName,AMX_GW_SAML_UserNameString
RequestAttributeMap=Password,AMX_GW_SAML_PasswordString
RequestAttributeMap=AuthnRequestID,AMX_GW_SamlAuthnIdString
RequestAttributeMap=AssertionID,AMX_GW_SAML_AssertionIDString
ResourceLocation=authenticate
ResponseHandlers=AuthResponseHandler
ResultCodeAttribute=GW_ClientResultCodeString
ResultStatusAttribute=GW_ClientResultStatusString


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/SAMLClient/Authentication/AuthResponseHandler]

ClassName=DelimitedTextResponseHandler
ContentType=text/html;charset=UTF-8
ResponseAttributeMap=SAMLResponse,AMX_GW_SAML_ResponseString
ResponseAttributeMap=WebLoginResponse,AMX_SAML_GatewayString
ResponseAttributeMap=RelayState,AMX_GW_SAML_RelayStateString
ResponseAttributeMap=AuthnRequestID,AMX_GW_SAML_ResponseIDString
ResponseAttributeMap=AssertionID,AMX_GW_SAML_AssertionIDString
ResponseAttributeMap=DestinationURL,AMX_GW_SAML_ResponseDestinationString
ResponseParameterSeparators=&


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/SAMLClient/EndPoints]

ClassName=com.hp.usage.connector.PrimarySecondaryEndPointSelector
EndPoints=Primary
EndPoints=Secondary
FailedEndPointRetryInterval=${CONNECTOR_TPCCLIENT_ENDPOINT_FAILENDPOINTRETRYINTERVAL}


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/SAMLClient/EndPoints/Primary]

ClassName=com.hp.usage.http.client.HttpEndPoint
ConnectionTimeout=${CONNECTOR_TPCCLIENT_SAML_ENDPOINT_CONNECTIONTIMEOUT}
KeyStoreFile=${ENV_TPCSERVER_KEYSTOREFILE}
KeyStorePassword=changeit
KeyStoreType=JKS
MaxConnections=${CONNECTOR_TPCCLIENT_SAML_ENDPOINT_NUMCONNECTIONS}
RemoteHostURL=${CONNECTOR_TPCCLIENT_SAML_ENDPOINT_REMOTEHOSTURL_1}
SocketTimeout=${CONNECTOR_TPCCLIENT_SAML_ENDPOINT_SOCKETTIMEOUT}


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/SAMLClient/EndPoints/Secondary]

ClassName=com.hp.usage.http.client.HttpEndPoint
ConnectionTimeout=${CONNECTOR_TPCCLIENT_SAML_ENDPOINT_CONNECTIONTIMEOUT}
KeyStoreFile=${ENV_TPCSERVER_KEYSTOREFILE}
KeyStorePassword=changeit
KeyStoreType=JKS
MaxConnections=${CONNECTOR_TPCCLIENT_SAML_ENDPOINT_NUMCONNECTIONS}
RemoteHostURL=${CONNECTOR_TPCCLIENT_SAML_ENDPOINT_REMOTEHOSTURL_2}
SocketTimeout=${CONNECTOR_TPCCLIENT_SAML_ENDPOINT_SOCKETTIMEOUT}


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/SAMLClient/Logout]

ClassName=com.hp.usage.http.client.PlainHttpRequest
CreateEmptyParameters=false
HttpMethod=POST
RequestAttributeMap=SAMLRequest,GW_SAMLRequestString
RequestAttributeMap=RelayState,AMX_GW_SAML_RelayStateString
ResourceLocation=logout
ResponseHandlers=LogoutResponseHandler
ResultCodeAttribute=GW_ClientResultCodeString
ResultStatusAttribute=GW_ClientResultStatusString


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/SAMLClient/Logout/LogoutResponseHandler]

ClassName=DelimitedTextResponseHandler
ContentType=text/html;charset=UTF-8
ResponseAttributeMap=SAMLResponse,AMX_GW_SAML_ResponseString
ResponseAttributeMap=RelayState,AMX_GW_SAML_RelayStateString


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/Schedulers]

ClassName=com.hp.siu.scheduler.Scheduler
ScheduledJobs=CleanSessionOld


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/Schedulers/CleanSessionOld]

PollIntervalClassName=ClockInterval
QueryInterval=5m
TaskLogLevel=DEBUG
Tasks=task1


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/Connectors/Schedulers/CleanSessionOld/task1]

ClassName=com.hp.siu.sessionserver.InvokeRuleChainTask
InputNMEAttributes=AMX_GW_StartTaskLong,7200
RuleChain=030.CleanOldSessions


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/ManagementService]

ClassName=com.hp.usage.management.ManagementService


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/PoolServiceNode]

ClassName=com.hp.usage.jdbc.poolservice.JDBCConnectionPoolService
ConnectionPools=Pool1


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/PoolServiceNode/Pool1]

ClassName=com.hp.usage.jdbc.poolservice.pool.JDBCConnectionPool
ConnectionTestQuery=select * from ALARM
CreateIncrement=1
Database=${SESSIONMANAGER_DATABASE}
DatabaseClass=${SESSIONMANAGER_DATABASE_CLASS}
InitialPoolSize=${SESSIONMANAGER_INITIALPOOLSIZE}
MaxPoolSize=${SESSIONMANAGER_MAXPOOLSIZE}
MinPoolSize=${SESSIONMANAGER_MINPOOLSIZE}
Password=${SESSIONMANAGER_PASSWORD}
User=${SESSIONMANAGER_USER}


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains]

ClassName=com.hp.siu.sessionserver.RuleChainManager
MaxPoolSize=${RULECHAINMANAGER_MAXPOOLSIZE}
MinPoolSize=${RULECHAINMANAGER_MINPOOLSIZE}
RuleChainNames=000.AuthnOIDRequest
RuleChainNames=000.UserInfoRequest
RuleChainNames=010.DoNothing
RuleChainNames=020.ResponseClient
RuleChainNames=030.CleanOldSessions
RuleChainNames=100.AuthenticateByOID
RuleChainNames=101.ReAuthenticateRule
RuleChainNames=102.ResponseAuthFromOID
RuleChainNames=103.GoToFlowToken
RuleChainNames=104.GetUserProfileFromOID
RuleChainNames=105.ResponseTokenFromOID
RuleChainNames=106.GetValuesFromSM
RuleChainNames=107.CreateSessionInDB
RuleChainNames=200.AuthenticateBySAML
RuleChainNames=201.ResponseCredentialsFromSAML
RuleChainNames=202.ResponseAuthFromSAML
RuleChainNames=300.RevokeRequest
RuleChainNames=301.ResponseRevokeFromOID
RuleChainNames=302.PrepareToLogoutSAML
RuleChainNames=303.ResponseLogoutFromSAML
RuleChainNames=800.ErrorHttpProtocol
RuleChainNames=810.ErrorHttpContext
RuleChainNames=820.ErrorExceptionFlow
RuleChainNames=830.ErrorSentRequest
RuleChainNames=840.ErrorInDB
RuleChainNames=850.ErrorInvalidTokenID
RuleChainNames=860.ErrorUserInfoLookup


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.AuthnOIDRequest]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin
RuleNames=020.SetResponseHandler
RuleNames=030.Initialize
RuleNames=040.CheckParameters
RuleNames=050.LookupLastLogin
RuleNames=060.CheckSendReAuthenticate
RuleNames=070.LogEnd


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.AuthnOIDRequest/010.LogBegin]

Attributes=AMX_AM_GW_USERNAME_String
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Message OID Authn Request :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.AuthnOIDRequest/020.SetResponseHandler]

AddInfoAttributeName=GW_AddInfoString
ClassName=com.hp.usage.throttling.ResponseHandlerRule
CorbaErrorAttributeName=GW_CorbaErrorAttributeString
ExceptionResponseRuleName=820.ErrorExceptionFlow
FaultResponseName=010.DoNothing
HttpErrorAttributeName=GW_HttpErrorAttrString
IUMPRDAttributeName=GW_PRDString
MessageAttributeName=GW_MessageString
NormalResponseRuleName=010.DoNothing
OtherExceptions=Mandatory parameter,GW_ResponseCodeString,GW_ReturnAttrNameInteger
OtherExceptions=Length check,GW_ResponseCodeString,GW_ReturnAttrNameInteger
OtherExceptions=RuleException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=IMP_LIMIT,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=TRANSIENT,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=OutOfBoundsException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=ConfigurationException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=NullPointerException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=OutOfMemoryException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=NamingException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=SCPInternal,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=IUMInternal,GW_InternalErrorString,GW_ReturnAttrNameInteger
PRDAttributeName=GW_PRDString
ResponseAttributeName=GW_ResponseCodeString
ReturnAttributeName=GW_ReturnAttrNameInteger
SCPErrorAttributeName=GW_SCPErrorAttrString
SCPPRDAttributeName=GW_SCPPRAttrString
SuccessResponseValue=GW_ResponseCodeSuccessString
SuccessReturnValue=GW_ReturnCodeSuccessInteger
ThrowExceptionFlagAttribute=GW_ThrowExceptionFlagInteger
ThrtBucketIDAttributeName=GW_ThrtBucketIDLong
TimeAttributeName=GW_TimeAttrString


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.AuthnOIDRequest/030.Initialize]

AdornOps=set Sender later
AdornOps=set GW_AddInfoString ""
AdornOps=set GW_CorbaErrorAttributeString ""
AdornOps=set GW_HttpErrorAttrString ""
AdornOps=set GW_PRDString 1
AdornOps=set GW_MessageString ""
AdornOps=set GW_ResponseCodeString 0
AdornOps=set GW_ReturnAttrNameInteger 0
AdornOps=set GW_ResponseCodeSuccessString 0
AdornOps=set GW_ReturnCodeSuccessInteger 0
AdornOps=set GW_ThrowExceptionFlagInteger 1
AdornOps=set GW_ReturnCodeInteger 0
AdornOps=set GW_InternalErrorString 500
AdornOps=set GW_HTTPContextMandatoryErrorString 400
AdornOps=set GW_HTTPContextLengthErrorString 411
AdornOps=set GW_HTTPCheckRetCodeInteger 1
AdornOps=set GW_FlagAuthnInteger 0
AdornOps=set GW_ErrorString 0
AdornOps=set GW_ErrorDescriptionString 0
AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set AMX_AM_GW_ResponseHandlerString "AuthnResponseHandler"
AdornOps=set AMX_GW_USERID 123456
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.AuthnOIDRequest/040.CheckParameters]

AddInfoNMEAttrName=GW_AddInfoString
AttributeCheck=AMX_AM_GW_USERNAME_String,y
AttributeCheck=AMX_GW_CLIENTID,y
AttributeCheck=AMX_AM_GW_ACR_VALUES_String,y,1-,
ClassName=com.hp.usage.throttling.NMEAttributesValidationRule
LengthCheckResCodeAttrName=GW_HTTPContextLengthErrorString
LengthCheckRetCodeAttrName=GW_HTTPCheckRetCodeInteger
LookupFailResCodeAttrName=GW_HTTPContextMandatoryErrorString
LookupFailRetCodeAttrName=GW_HTTPCheckRetCodeInteger
MandOptCheckResCodeAttrName=GW_HTTPContextMandatoryErrorString
MandOptCheckRetCodeAttrName=GW_HTTPCheckRetCodeInteger
ResCodeNMEAttrName=GW_ResponseCodeString
RetCodeNMEAttrName=GW_ReturnCodeInteger


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.AuthnOIDRequest/050.LookupLastLogin]

Attributes=AMX_GW_USERID,key
Attributes=AMX_GW_SESSIONID
Attributes=AMX_GW_CLIENT_ID_ISSUER
Attributes=AMX_GW_CLIENTID
Attributes=AMX_GW_LOGINNAME
Attributes=AMX_GW_CODE
Attributes=AMX_GW_STATE
Attributes=AMX_GW_ACCESS_TOKEN
Attributes=AMX_GW_REFRESH_TOKEN
Attributes=AMX_GW_NONCE
Attributes=AMX_GW_ENDTIMETOKENID
Attributes=AMX_GW_CONTEXT
Attributes=AMX_GW_SESSIONINFO
Attributes=AMX_GW_SAMLAUTHNID
Attributes=AMX_GW_SAMLASSERTION
Attributes=AMX_GW_STARTTIME
Attributes=AMX_GW_ENDTIME
ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
LogInvalidSession=false
MapAttributes=AMX_GW_ClientString,AMX_GW_CLIENTID
MapAttributes=AMX_GW_LoginNameString,AMX_GW_LOGINNAME
MapAttributes=AMX_GW_SamlAuthnIdString,AMX_GW_SAMLAUTHNID
MapAttributes=AMX_GW_ACCESS_TOKEN,AMX_GW_ACCESS_TOKEN
MapAttributes=AMX_GW_StartTimeLong,AMX_GW_STARTTIME
MapAttributes=AMX_GW_FinishTimeLong,AMX_GW_ENDTIME
NotExistsErrorRuleChain=100.AuthenticateByOID
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.AuthnOIDRequest/060.CheckSendReAuthenticate]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=GW_FlagAuthnInteger,=,0
TrueRuleChain=010.CheckAuthnType


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.AuthnOIDRequest/060.CheckSendReAuthenticate/010.CheckAuthnType]

001.AuthnByOID=100.AuthnByOIDRule
002.AuthnBySAML=200.AuthnBySAMLRule
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=AMX_GW_ACCESS_TOKEN,!=,none
Conditions=AMX_GW_SamlAuthnIdString,!=,none
TrueRuleChain=001.AuthnByOID
TrueRuleChain=002.AuthnBySAML


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.AuthnOIDRequest/060.CheckSendReAuthenticate/010.CheckAuthnType/100.AuthnByOIDRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=101.ReAuthenticateRule
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.AuthnOIDRequest/060.CheckSendReAuthenticate/010.CheckAuthnType/200.AuthnBySAMLRule]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200.AuthenticateBySAML
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.AuthnOIDRequest/070.LogEnd]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Message OID Authn Response :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin
RuleNames=020.SetResponseHandler
RuleNames=030.Initialize
RuleNames=040.CheckParameters
RuleNames=050.CheckForToken
RuleNames=070.Mapping
RuleNames=070.LogEnd
RuleNames=080.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/010.LogBegin]

Attributes=AMX_GW_USERID
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Message User Info Request :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/020.SetResponseHandler]

AddInfoAttributeName=GW_AddInfoString
ClassName=com.hp.usage.throttling.ResponseHandlerRule
CorbaErrorAttributeName=GW_CorbaErrorAttributeString
ExceptionResponseRuleName=820.ErrorExceptionFlow
FaultResponseName=010.DoNothing
HttpErrorAttributeName=GW_HttpErrorAttrString
IUMPRDAttributeName=GW_PRDString
MessageAttributeName=GW_MessageString
NormalResponseRuleName=010.DoNothing
OtherExceptions=Mandatory parameter,GW_ResponseCodeString,GW_ReturnAttrNameInteger
OtherExceptions=Length check,GW_ResponseCodeString,GW_ReturnAttrNameInteger
OtherExceptions=RuleException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=IMP_LIMIT,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=TRANSIENT,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=OutOfBoundsException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=ConfigurationException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=NullPointerException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=OutOfMemoryException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=NamingException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=SCPInternal,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=IUMInternal,GW_InternalErrorString,GW_ReturnAttrNameInteger
PRDAttributeName=GW_PRDString
ResponseAttributeName=GW_ResponseCodeString
ReturnAttributeName=GW_ReturnAttrNameInteger
SCPErrorAttributeName=GW_SCPErrorAttrString
SCPPRDAttributeName=GW_SCPPRAttrString
SuccessResponseValue=GW_ResponseCodeSuccessString
SuccessReturnValue=GW_ReturnCodeSuccessInteger
ThrowExceptionFlagAttribute=GW_ThrowExceptionFlagInteger
ThrtBucketIDAttributeName=GW_ThrtBucketIDLong
TimeAttributeName=GW_TimeAttrString


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/030.Initialize]

AdornOps=set Sender later
AdornOps=set GW_AddInfoString ""
AdornOps=set GW_CorbaErrorAttributeString ""
AdornOps=set GW_HttpErrorAttrString ""
AdornOps=set GW_PRDString 1
AdornOps=set GW_MessageString ""
AdornOps=set GW_ResponseCodeString 0
AdornOps=set GW_ReturnAttrNameInteger 0
AdornOps=set GW_ResponseCodeSuccessString 0
AdornOps=set GW_ReturnCodeSuccessInteger 0
AdornOps=set GW_ThrowExceptionFlagInteger 1
AdornOps=set GW_ReturnCodeInteger 0
AdornOps=set GW_InternalErrorString 500
AdornOps=set GW_HTTPContextMandatoryErrorString 400
AdornOps=set GW_HTTPContextLengthErrorString 411
AdornOps=set GW_HTTPCheckRetCodeInteger 1
AdornOps=set GW_FlagAuthnInteger 0
AdornOps=set GW_ErrorString 0
AdornOps=set GW_ErrorDescriptionString 0
AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set AMX_AM_GW_ResponseHandlerString "UserInfoResponseHandler"
AdornOps=set AMX_GW_EXITFLAG 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/040.CheckParameters]

AddInfoNMEAttrName=GW_AddInfoString
AttributeCheck=AMX_GW_TOKENID,y
AttributeCheck=AMX_GW_CLIENT_ID_ISSUER,y
ClassName=com.hp.usage.throttling.NMEAttributesValidationRule
LengthCheckResCodeAttrName=GW_HTTPContextLengthErrorString
LengthCheckRetCodeAttrName=GW_HTTPCheckRetCodeInteger
LookupFailResCodeAttrName=GW_HTTPContextMandatoryErrorString
LookupFailRetCodeAttrName=GW_HTTPCheckRetCodeInteger
MandOptCheckResCodeAttrName=GW_HTTPContextMandatoryErrorString
MandOptCheckRetCodeAttrName=GW_HTTPCheckRetCodeInteger
ResCodeNMEAttrName=GW_ResponseCodeString
RetCodeNMEAttrName=GW_ReturnCodeInteger


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_TOKENID,contains,.
FalseRuleChain=020.AccessToken
TrueRuleChain=010.IdToken


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken]

ClassName=RuleChain
RuleNames=050.DecodeJWT
RuleNames=060.LookupLastLogin


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/050.DecodeJWT]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=020.SplitToken1
RuleNames=030.Decode64
RuleNames=000.Log
RuleNames=040.SplitSessionID
RuleNames=000.Log1
RuleNames=050.SetValues


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/050.DecodeJWT/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=:::::: DECODE JWT :::::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/050.DecodeJWT/000.Log1]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=:::::: AFTER SPLIT:::::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/050.DecodeJWT/020.SplitToken1]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
DestinationAttribute=AMX_GW_JWT
DestinationAttribute=AMX_GW_JWT_PAYLOAD
DestinationAttribute=AMX_GW_JWT_HEADER
Operation=split
RegExPattern=(.*)\.(.*)\.(.*)
SourceAttribute=AMX_GW_TOKENID


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/050.DecodeJWT/030.Decode64]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LenghtPayload
RuleNames=020.CheckLenght
RuleNames=030.Decode64


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/050.DecodeJWT/030.Decode64/010.LenghtPayload]

AdornOps=length AMX_GW_JWT_PAYLOAD AMX_GW_JWT_PAYLOAD_INT
AdornOps=% AMX_GW_JWT_PAYLOAD_INT 4 AMX_GW_JWT_PAYLOAD_INT
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/050.DecodeJWT/030.Decode64/020.CheckLenght]

001.AddValueOne=AddValue
002.AddValueTwo=AddValueTwo
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=AMX_GW_JWT_PAYLOAD_INT,=,3
Conditions=AMX_GW_JWT_PAYLOAD_INT,=,2
TrueRuleChain=001.AddValueOne
TrueRuleChain=002.AddValueTwo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/050.DecodeJWT/030.Decode64/020.CheckLenght/AddValue]

AdornOps=+ AMX_GW_JWT_PAYLOAD = AMX_GW_JWT_PAYLOAD
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/050.DecodeJWT/030.Decode64/020.CheckLenght/AddValueTwo]

AdornOps=+ AMX_GW_JWT_PAYLOAD == AMX_GW_JWT_PAYLOAD
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/050.DecodeJWT/030.Decode64/030.Decode64]

AdornOps=decBase64 AMX_GW_JWT_PAYLOAD AMX_GW_BinaryJWT
AdornOps=bin2str AMX_GW_BinaryJWT AMX_GW_JWT_STR "UTF-8"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/050.DecodeJWT/040.SplitSessionID]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
DestinationAttribute=AMX_GW_JWT
DestinationAttribute=AMX_GW_JWT_PAYLOAD
DestinationAttribute=AMX_GW_JWT_HEADER
Operation=split
RegExPattern=(.*)"session_id":"(.*)",(.*)
SourceAttribute=AMX_GW_JWT_STR


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/050.DecodeJWT/050.SetValues]

AdornOps=copy AMX_GW_JWT_PAYLOAD AMX_GW_SESSIONID
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/010.IdToken/060.LookupLastLogin]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=false
LogInvalidSession=false
MapAttributes=AMX_GW_SESSIONID,AMX_GW_SESSIONID
MapAttributes=AMX_GW_SAMLASSERTION,AMX_GW_SAMLASSERTION
NativeCondition=BySessionID
NotExistsErrorRuleChain=860.ErrorUserInfoLookup
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/020.AccessToken]

ClassName=RuleChain
RuleNames=030.SetAccessToken
RuleNames=060.LookupLastLogin


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/020.AccessToken/030.SetAccessToken]

AdornOps=copy AMX_GW_TOKENID AMX_GW_ACCESS_TOKEN
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/050.CheckForToken/020.AccessToken/060.LookupLastLogin]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=false
LogInvalidSession=false
MapAttributes=AMX_GW_SESSIONID,AMX_GW_SESSIONID
MapAttributes=AMX_GW_SAMLASSERTION,AMX_GW_SAMLASSERTION
MapAttributes=AMX_GW_ACCESS_TOKEN,AMX_GW_ACCESS_TOKEN
NativeCondition=ByAccessToken
NotExistsErrorRuleChain=860.ErrorUserInfoLookup
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/060.LookupLastLogin]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=false
LogInvalidSession=false
MapAttributes=AMX_GW_SESSIONID,AMX_GW_SESSIONID
MapAttributes=AMX_GW_SAMLASSERTION,AMX_GW_SAMLASSERTION
MapAttributes=AMX_GW_ACCESS_TOKEN,AMX_GW_ACCESS_TOKEN
NativeCondition=ByAccessToken
NotExistsErrorRuleChain=860.ErrorUserInfoLookup
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.LogEnd]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Message User Info Response :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping]

ClassName=com.hp.usage.bulkcm.LoopRule
ExitConditions=AMX_GW_EXITFLAG,=,1
RetryCount=100
RetryDelay=5
RuleNames=070.Mapping


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.LogInitial
RuleNames=001.SplitXMLTag
RuleNames=002.CheckExitFlag
RuleNames=002.GetXMLValue
RuleNames=003.MappingOID
RuleNames=000.LogFinal


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/000.LogFinal]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: After Replace :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/000.LogInitial]

Attributes=AMX_GW_SAMLASSERTION
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Init Loop :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/001.SplitXMLTag]

AdornOps=indexof "<saml:Attribute " AMX_GW_SAMLASSERTION AMX_GW_SAMLASSERTION_INT1
AdornOps=indexof "</saml:Attribute>" AMX_GW_SAMLASSERTION AMX_GW_SAMLASSERTION_INT2
AdornOps=lastindexof "<saml:Attribute " AMX_GW_SAMLASSERTION AMX_GW_SAMLASSERTION_INT3
AdornOps=+ AMX_GW_SAMLASSERTION_INT2 17 AMX_GW_SAMLASSERTION_INT2
AdornOps=substr AMX_GW_SAMLASSERTION_INT1 AMX_GW_SAMLASSERTION_INT2 AMX_GW_SAMLASSERTION AMX_GW_SAMLASSERTION_1
AdornOps=substr AMX_GW_SAMLASSERTION_INT2 length AMX_GW_SAMLASSERTION AMX_GW_SAMLASSERTION
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/002.CheckExitFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_SAMLASSERTION_INT1,=,AMX_GW_SAMLASSERTION_INT3
FalseRuleChain=000.Log
TrueRuleChain=setFlagExit
TrueRuleChain=000.LogTrue


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/002.CheckExitFlag/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Conditional False:::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/002.CheckExitFlag/000.LogTrue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Conditional true:::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/002.CheckExitFlag/setFlagExit]

AdornOps=set AMX_GW_EXITFLAG 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/002.GetXMLValue]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.GetNameandValue


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/002.GetXMLValue/001.GetNameandValue]

AdornOps=indexof "Name=" AMX_GW_SAMLASSERTION_1 AMX_GW_SAMLASSERTION_INT1
AdornOps=indexof " NameFormat=" AMX_GW_SAMLASSERTION_1 AMX_GW_SAMLASSERTION_INT2
AdornOps=+ AMX_GW_SAMLASSERTION_INT1 6 AMX_GW_SAMLASSERTION_INT1
AdornOps=- AMX_GW_SAMLASSERTION_INT2 1 AMX_GW_SAMLASSERTION_INT2
AdornOps=substr AMX_GW_SAMLASSERTION_INT1 AMX_GW_SAMLASSERTION_INT2 AMX_GW_SAMLASSERTION_1 AMX_GW_NAME
AdornOps=indexof "AttributeValue" AMX_GW_SAMLASSERTION_1 AMX_GW_SAMLASSERTION_INT1
AdornOps=substr AMX_GW_SAMLASSERTION_INT1 length AMX_GW_SAMLASSERTION_1 AMX_GW_SAMLASSERTION_1
AdornOps=indexof ">" AMX_GW_SAMLASSERTION_1 AMX_GW_SAMLASSERTION_INT1
AdornOps=indexof "<" AMX_GW_SAMLASSERTION_1 AMX_GW_SAMLASSERTION_INT2
AdornOps=+ AMX_GW_SAMLASSERTION_INT1 1 AMX_GW_SAMLASSERTION_INT1
AdornOps=substr AMX_GW_SAMLASSERTION_INT1 AMX_GW_SAMLASSERTION_INT2 AMX_GW_SAMLASSERTION_1 AMX_GW_VALUE
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID]

Address=Address
Birthdate=Birthdate
Businessregion=Businessregion
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=AMX_GW_NAME,=,"username"
Conditions=AMX_GW_NAME,=,"usergivenname"
Conditions=AMX_GW_NAME,=,"userfamilyname"
Conditions=AMX_GW_NAME,=,"nickname"
Conditions=AMX_GW_NAME,=,"userdisplayname"
Conditions=AMX_GW_NAME,=,"profileurl"
Conditions=AMX_GW_NAME,=,"photourl"
Conditions=AMX_GW_NAME,=,"emailaddr"
Conditions=AMX_GW_NAME,=,"emailverified"
Conditions=AMX_GW_NAME,=,"gender"
Conditions=AMX_GW_NAME,=,"birthdate"
Conditions=AMX_GW_NAME,=,"timezone"
Conditions=AMX_GW_NAME,=,"locale"
Conditions=AMX_GW_NAME,=,"phonenumber"
Conditions=AMX_GW_NAME,=,"phonenumberverified"
Conditions=AMX_GW_NAME,=,"addressid"
Conditions=AMX_GW_NAME,=,"updatedate"
Conditions=AMX_GW_NAME,=,"roleid"
Conditions=AMX_GW_NAME,=,"supervisor"
Conditions=AMX_GW_NAME,=,"businessregion"
Emailaddr=Emailaddr
Emailverified=Emailverified
Gender=Gender
Locale=Locale
Nickname=Nickname
Phonenumber=Phonenumber
Phonenumberverified=Phonenumberverified
Photourl=Photourl
Profileurl=Profileurl
Rol=Rol
Supervisor=Supervisor
Timezone=Timezone
TrueRuleChain=Username
TrueRuleChain=Usergivenname
TrueRuleChain=Userfamilyname
TrueRuleChain=Nickname
TrueRuleChain=Userdisplayname
TrueRuleChain=Profileurl
TrueRuleChain=Photourl
TrueRuleChain=Emailaddr
TrueRuleChain=Emailverified
TrueRuleChain=Gender
TrueRuleChain=Birthdate
TrueRuleChain=Timezone
TrueRuleChain=Locale
TrueRuleChain=Phonenumber
TrueRuleChain=Phonenumberverified
TrueRuleChain=Address
TrueRuleChain=Updatedate
TrueRuleChain=Rol
TrueRuleChain=Supervisor
TrueRuleChain=Businessregion
Updatedate=Updatedate
Userdisplayname=Userdisplayname
Userfamilyname=Userfamilyname
Usergivenname=Usergivenname
Username=Username


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Address]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Address


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Address/Address]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,address.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Address/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for Address is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Birthdate]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Birthdate


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Birthdate/Birthdate]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,birthdate.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Birthdate/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for Birthdate is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Businessregion]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Businessregion


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Businessregion/Businessregion]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,region.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Businessregion/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for Businessregion is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Emailaddr]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Emailaddr


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Emailaddr/Emailaddr]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,email.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Emailaddr/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for Email is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Emailverified]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Emailverified


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Emailverified/Emailverified]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,email_verified.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Emailverified/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for EmailVerified is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Gender]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Gender


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Gender/Gender]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,gender.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Gender/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for Gender is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Locale]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Locale


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Locale/Locale]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,locale.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Locale/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for Locale is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Nickname]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Nickname


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Nickname/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for NickName is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Nickname/Nickname]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,nickname.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Phonenumber]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Phonenumber


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Phonenumber/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for PhoneNumber is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Phonenumber/Phonenumber]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,phone_number.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Phonenumberverified]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Phonenumberverified


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Phonenumberverified/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for PhoneNumberVerified is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Phonenumberverified/Phonenumberverified]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,phone_number_verified.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Photourl]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Photourl


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Photourl/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for PhotoURL is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Photourl/Photourl]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,picture.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Profileurl]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Profileurl


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Profileurl/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for ProfileURL is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Profileurl/Profileurl]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,profile.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Rol]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Rol


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Rol/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for Rol is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Rol/Rol]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,rol.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Supervisor]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Supervisor


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Supervisor/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for Supervisor is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Supervisor/Supervisor]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,supervisor.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Timezone]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Timezone


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Timezone/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for TimeZone is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Timezone/Timezone]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,zoneinfo.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Updatedate]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Updatedate


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Updatedate/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for Update_ad is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Updatedate/Updatedate]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,updated_at.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Userdisplayname]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Userdisplayname


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Userdisplayname/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for PreferUserName is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Userdisplayname/Userdisplayname]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,preferred_username.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Userfamilyname]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Userfamilyname


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Userfamilyname/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for UserFamilyName is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Userfamilyname/Userfamilyname]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,family_name.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Usergivenname]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Usergivenname


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Usergivenname/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for UserGiveName is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Usergivenname/Usergivenname]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,given_name.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Username]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_VALUE,!=,""
FalseRuleChain=LogEmptyValue
TrueRuleChain=Username


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Username/LogEmptyValue]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Value for UserName is empty :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/070.Mapping/070.Mapping/003.MappingOID/Username/Username]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_VALUE,name.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/000.UserInfoRequest/080.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/010.DoNothing]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/010.DoNothing/010.LogBegin]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: DoNothing :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/020.ResponseClient]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin
RuleNames=020.SetParams
RuleNames=030.Response


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/020.ResponseClient/010.LogBegin]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Response to Client :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/020.ResponseClient/020.SetParams]

AdornOps=set Sender later
AdornOps=setifnull AMX_GW_HttpStatusInteger 200
AdornOps=setifnull GW_ErrorString 0
AdornOps=setifnull GW_ErrorDescriptionString success
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/020.ResponseClient/030.Response]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=GW_OperationAttrString,contains,"Token"
FalseRuleChain=002.ReponseByOID
TrueRuleChain=001.SetResponseToken


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/020.ResponseClient/030.Response/001.SetResponseToken]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=SetResponseHandler
RuleNames=ReponseByOID


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/020.ResponseClient/030.Response/001.SetResponseToken/000.Log]

Attributes=ErrorDescription
Attributes=GW_ErrorString
Attributes=AMX_AM_GW_ResponseHandlerString
Attributes=GW_ErrorDescriptionString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Response to Client LastOne Token:::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/020.ResponseClient/030.Response/001.SetResponseToken/ConditionResponse]

ClassName=ConditionalRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/020.ResponseClient/030.Response/001.SetResponseToken/ReponseByOID]

ClassName=SendResponseRule
ConnectorName=OIDServer
ErrorCodeAttribute=GW_HTTPClientErrorCodeString
ErrorMessageAttribute=GW_HTTPClientErrorMessageString


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/020.ResponseClient/030.Response/001.SetResponseToken/SetResponseHandler]

AdornOps=set AMX_AM_GW_ResponseHandlerString "TokenResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/020.ResponseClient/030.Response/002.ReponseByOID]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=002.ReponseByOID


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/020.ResponseClient/030.Response/002.ReponseByOID/000.Log]

Attributes=AMX_GW_CODE
Attributes=ErrorDescription
Attributes=GW_ErrorString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Response to Client LastOne:::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/020.ResponseClient/030.Response/002.ReponseByOID/002.ReponseByOID]

ClassName=SendResponseRule
ConnectorName=OIDServer
ErrorCodeAttribute=GW_HTTPClientErrorCodeString
ErrorMessageAttribute=GW_HTTPClientErrorMessageString


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/030.CleanOldSessions]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.SetParams
RuleNames=020.DeleteRegister


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/030.CleanOldSessions/010.SetParams]

AdornOps=* AMX_GW_StartTaskLong 1000 AMX_GW_StartTaskLong
AdornOps=setsystime AMX_GW_FinishTimeLong
AdornOps=- AMX_GW_FinishTimeLong AMX_GW_StartTaskLong AMX_GW_FinishTimeLong
AdornOps=copy AMX_GW_FinishTimeLong AMX_GW_ENDTIME
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/030.CleanOldSessions/020.DeleteRegister]

ClassName=PurgeSessionsRule
ContinueAfterErrorFixed=true
PurgeConditions=AMX_GW_ENDTIME,<=,%AMX_GW_ENDTIME
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/100.AuthenticateByOID]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin
RuleNames=020.SetParamsForAuthn
RuleNames=030.CheckAuthnFlag
RuleNames=040.EncodeRequest
RuleNames=050.SendHTTPRequest


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/100.AuthenticateByOID/010.LogBegin]

Attributes=AMX_GW_USERID
Attributes=GW_FlagAuthnInteger
Attributes=AMX_AM_GW_ACR_VALUES_String
Attributes=AMX_GW_CLIENTID
Attributes=AMX_GW_ClientString
Attributes=AMX_AM_GW_MSISDNString
Attributes=AMX_AM_GW_PWD_String
Attributes=AMX_GW_LoginNameString
Attributes=AMX_GW_SamlAuthnIdString
Attributes=AMX_GW_ACCESS_TOKEN
Attributes=AMX_GW_StartTimeLong
Attributes=AMX_GW_FinishTimeLong
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Send Authentication :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/100.AuthenticateByOID/020.SetParamsForAuthn]

AdornOps=set GW_OperationAttrString Authentication
AdornOps=setifnull AMX_AM_GW_RESPONSE_TYPE_String code
AdornOps=setifnull AMX_AM_GW_SCOPE_String openid
AdornOps=setifnull AMX_GW_REDIRECT_URI_String http://labmobileid.telcel.com:9015/callback/catcher
AdornOps=setifnull AMX_GW_STATE afOifjsldkj
AdornOps=setifnull AMX_GW_NONCE sdj223ddSS
AdornOps=set GW_ContentTypeString "application/json"
AdornOps=set GW_HTTPClientErrorCodeString 0
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/100.AuthenticateByOID/030.CheckAuthnFlag]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=GW_FlagAuthnInteger,=,0
TrueRuleChain=010.ChangeFlag


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/100.AuthenticateByOID/030.CheckAuthnFlag/010.ChangeFlag]

AdornOps=set GW_FlagAuthnInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/100.AuthenticateByOID/040.EncodeRequest]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_AM_GW_RESPONSE_TYPE_String,requestOID.requestAuthorize.response_type.CData
NMEToStructuredNMEMap=AMX_AM_GW_SCOPE_String,requestOID.requestAuthorize.scope.CData
NMEToStructuredNMEMap=AMX_GW_STATE,requestOID.requestAuthorize.state.CData
NMEToStructuredNMEMap=AMX_GW_NONCE,requestOID.requestAuthorize.nonce.CData
NMEToStructuredNMEMap=AMX_AM_GW_ACR_VALUES_String,requestOID.requestAuthorize.acr_values.CData
NMEToStructuredNMEMap=AMX_GW_CLIENT_ID_ISSUER,requestOID.requestAuthorize.client_issuer.CData
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/100.AuthenticateByOID/050.SendHTTPRequest]

ClassName=com.hp.usage.lookup.AsynchronousLookupRule
ConnectorName=OIDClient
ErrorCodeAttribute=GW_HTTPClientErrorCodeString
ErrorMessageAttribute=GW_HTTPClientErrorMessageString
ErrorRuleChain=830.ErrorSentRequest
SuccessRuleChain=102.ResponseAuthFromOID


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/101.ReAuthenticateRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin
RuleNames=020.SetParamsForReauthn
RuleNames=030.ResponseToClient
RuleNames=040.EncodeRequest
RuleNames=050.SendHTTPRequest


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/101.ReAuthenticateRule/010.LogBegin]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Send Reauthentication :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/101.ReAuthenticateRule/020.SetParamsForReauthn]

AdornOps=set GW_OperationAttrString Authentication
AdornOps=set AMX_AM_GW_RESPONSE_TYPE_String token
AdornOps=set AMX_AM_GW_SCOPE_String openid
AdornOps=set AMX_GW_REDIRECT_URI_String http://labmobileid.telcel.com:9015/callback/catcher
AdornOps=set AMX_GW_STATE afOifjsldkj
AdornOps=set AMX_GW_NONCE sdj223ddSS
AdornOps=set GW_ContentTypeString "application/json"
AdornOps=copy AMX_GW_ACCESS_TOKEN AMX_AM_GW_ID_TOKEN_HINT_String
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/101.ReAuthenticateRule/030.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/101.ReAuthenticateRule/040.EncodeRequest]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_AM_GW_RESPONSE_TYPE_String,requestOID.requestAuthorize.response_type.CData
NMEToStructuredNMEMap=AMX_AM_GW_SCOPE_String,requestOID.requestAuthorize.scope.CData
NMEToStructuredNMEMap=AMX_GW_STATE,requestOID.requestAuthorize.state.CData
NMEToStructuredNMEMap=AMX_GW_NONCE,requestOID.requestAuthorize.nonce.CData
NMEToStructuredNMEMap=AMX_AM_GW_ACR_VALUES_String,requestOID.requestAuthorize.acr_values.CData
NMEToStructuredNMEMap=AMX_AM_GW_ID_TOKEN_HINT_String,requestOID.requestAuthorize.id_token_hint.CData
NMEToStructuredNMEMap=AMX_GW_CLIENTID,requestOID.requestAuthorize.client_id.CData
NMEToStructuredNMEMap=AMX_GW_REDIRECT_URI_String,requestOID.requestAuthorize.redirect_uri.CData
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/101.ReAuthenticateRule/050.SendHTTPRequest]

ClassName=com.hp.usage.lookup.AsynchronousLookupRule
ConnectorName=OIDClient
ErrorCodeAttribute=GW_HTTPClientErrorCodeString
ErrorMessageAttribute=GW_HTTPClientErrorMessageString
ErrorRuleChain=830.ErrorSentRequest
SuccessRuleChain=102.ResponseAuthFromOID


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin
RuleNames=020.CheckErrorResponse


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/010.LogBegin]

Attributes=GW_FlagAuthnInteger
Attributes=GW_ErrorString
Attributes=GW_ErrorDescriptionString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Return from BackEnd OID Server AUTHN Req :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=GW_ErrorString,is,null
Conditions=GW_ErrorString,=,""
Conditions=AMX_GW_CODE,!=,""
FalseRuleChain=010.SetErrors
Operations=or
Operations=or
TrueRuleChain=030.ValidateRequestType


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/010.SetErrors]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=010.SetErrors
RuleNames=020.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/010.SetErrors/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::::: Set Errors from AM::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/010.SetErrors/010.SetErrors]

AdornOps=copy  GW_ClientResultCodeString AMX_GW_HttpStatusInteger
AdornOps=set RequestType "response"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/010.SetErrors/020.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/030.ValidateRequestType]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=010.ValidateRequestType


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/030.ValidateRequestType/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::::: ValidateRequestType::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/030.ValidateRequestType/010.ValidateRequestType]

ClassName=com.hp.siu.collector.rules.ConditionalRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/030.ValidateRequestType/010.ValidateRequestType/Condition]

ClassName=com.hp.usage.nme.rules.SNMECondition
Condition=isSet(requestOID.requestAuthorize.id_token_hint.CData),==,true
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/030.ValidateRequestType/010.ValidateRequestType/FalseRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=010.SetParams
RuleNames=020.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/030.ValidateRequestType/010.ValidateRequestType/FalseRule/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::::: Id_Token False::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/030.ValidateRequestType/010.ValidateRequestType/FalseRule/010.SetParams]

AdornOps=set GW_ErrorString 0
AdornOps=copy GW_ClientResultCodeString AMX_GW_HttpStatusInteger 200
AdornOps=set AMX_AM_GW_ResponseHandlerString "AuthnResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/030.ValidateRequestType/010.ValidateRequestType/FalseRule/020.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/030.ValidateRequestType/010.ValidateRequestType/TrueRule]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.SetParams
RuleNames=020.Update


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/030.ValidateRequestType/010.ValidateRequestType/TrueRule/010.SetParams]

AdornOps=copy AMX_GW_CLIENTID AMX_GW_ClientString
AdornOps=copy AMX_GW_CODE AMX_GW_ACCESS_TOKEN
AdornOps=set GW_ErrorString 0
AdornOps=set AMX_GW_HttpStatusInteger 200
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/102.ResponseAuthFromOID/020.CheckErrorResponse/030.ValidateRequestType/010.ValidateRequestType/TrueRule/020.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=840.ErrorInDB
MapAttributes=AMX_GW_ClientString
MapAttributes=AMX_GW_ACCESS_TOKEN
NativeCondition=ByAuthnId
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/103.GoToFlowToken]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.SetTokenValues
RuleNames=020.EncodeRequest
RuleNames=030.SendHTTPRequest


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/103.GoToFlowToken/010.SetTokenValues]

AdornOps=set GW_OperationAttrString Token
AdornOps=set GW_FlagAuthnInteger 1
AdornOps=set AMX_GW_GRANT_TYPE_String authorization_code
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/103.GoToFlowToken/020.EncodeRequest]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_CODE,requestOID.requestToken.code.CData
NMEToStructuredNMEMap=AMX_GW_GRANT_TYPE_String,requestOID.requestToken.grant_type.CData
NMEToStructuredNMEMap=AMX_GW_REDIRECT_URI_String,requestOID.requestAuthorize.redirect_uri.CData
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/103.GoToFlowToken/030.SendHTTPRequest]

ClassName=com.hp.usage.lookup.AsynchronousLookupRule
ConnectorName=OIDClient
ErrorCodeAttribute=GW_HTTPClientErrorCodeString
ErrorMessageAttribute=GW_HTTPClientErrorMessageString
ErrorRuleChain=830.ErrorSentRequest
SuccessRuleChain=105.ResponseTokenFromOID


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/104.GetUserProfileFromOID]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin
RuleNames=020.SetParams
RuleNames=030.SetJsonMessage
RuleNames=040.SendHTTPRequest


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/104.GetUserProfileFromOID/010.LogBegin]

Attributes=AMX_GW_USERID
Attributes=AMX_GW_CLIENTID
Attributes=AMX_GW_ClientString
Attributes=AMX_GW_LoginNameString
Attributes=AMX_GW_SamlAuthnIdString
Attributes=AMX_GW_ACCESS_TOKEN
Attributes=AMX_GW_StartTimeLong
Attributes=AMX_GW_FinishTimeLong
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Send User Profile :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/104.GetUserProfileFromOID/020.SetParams]

AdornOps=set GW_OperationAttrString UserInfo
AdornOps=set AMX_GW_ACCESS_TOKEN_String "Bearer "
AdornOps=+ AMX_GW_ACCESS_TOKEN_String AMX_GW_ACCESS_TOKEN AMX_GW_ACCESS_TOKEN_String
AdornOps=set GW_OutTokenTypeString Bearer
AdornOps=set AMX_AM_GW_SCOPE_String "openid reauth"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/104.GetUserProfileFromOID/030.SetJsonMessage]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_ACCESS_TOKEN,requestOID.requestUserInfo.access_token.CData
NMEToStructuredNMEMap=GW_OutTokenTypeString,requestOID.requestUserInfo.token_type.CData,Bearer
NMEToStructuredNMEMap=AMX_GW_CLIENTID,request.client.clientname.CData
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/104.GetUserProfileFromOID/040.SendHTTPRequest]

ClassName=com.hp.usage.lookup.AsynchronousLookupRule
ConnectorName=OIDClient
ErrorCodeAttribute=GW_HTTPClientErrorCodeString
ErrorMessageAttribute=GW_HTTPClientErrorMessageString
ErrorRuleChain=830.ErrorSentRequest
SuccessRuleChain=108.ResponseUserInfoFromOID


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/105.ResponseTokenFromOID]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin
RuleNames=020.GetResponseValues
RuleNames=030.CheckResultCode


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/105.ResponseTokenFromOID/010.LogBegin]

Attributes=GW_FlagAuthnInteger
Attributes=GW_ErrorString
Attributes=GW_ErrorDescriptionString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Return from BackEnd OID Server TOKEN Req :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/105.ResponseTokenFromOID/020.GetResponseValues]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
SNMEType=SSO_CORP:ResponseToken
StructuredNMEToNMEMap=access_token.CData,AMX_GW_ACCESS_TOKEN_String
StructuredNMEToNMEMap=token_type.CData,GW_OutTokenTypeString
StructuredNMEToNMEMap=id_token.CData,GW_OutIDTokenString
StructuredNMEToNMEMap=expires_in.CData,GW_OutExpiresInString
StructuredNMEToNMEMap=refresh_token.CData,GW_OutRefreshTokenString
StructuredNMEToNMEMap=error.CData,GW_ErrorString
StructuredNMEToNMEMap=error_description.CData,GW_ErrorDescriptionString


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/105.ResponseTokenFromOID/030.CheckResultCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=GW_ErrorString,=,Seccessful
FalseRuleChain=010.SetErrors
TrueRuleChain=040.PrepareToGoSM


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/105.ResponseTokenFromOID/030.CheckResultCode/010.SetErrors]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=010.SetErrors
RuleNames=015.EncodeError
RuleNames=020.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/105.ResponseTokenFromOID/030.CheckResultCode/010.SetErrors/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::::: Set Errors from Token::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/105.ResponseTokenFromOID/030.CheckResultCode/010.SetErrors/010.SetErrors]

AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set AMX_AM_GW_ResponseHandlerString "TokenResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/105.ResponseTokenFromOID/030.CheckResultCode/010.SetErrors/015.EncodeError]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=GW_ErrorString,responseToken.error.CData
NMEToStructuredNMEMap=GW_ErrorDescriptionString,responseToken.error_description.CData
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/105.ResponseTokenFromOID/030.CheckResultCode/010.SetErrors/020.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/105.ResponseTokenFromOID/030.CheckResultCode/040.PrepareToGoSM]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=106.GetValuesFromSM
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/105.ResponseTokenFromOID/040.PrepareToGoSM]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=106.GetValuesFromSM
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.SetRequestValues
RuleNames=020.SNMEToSM
RuleNames=000.Log
RuleNames=030.InvokeSessionManager


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Before  go to Session Manager Req :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/010.SetRequestValues]

AdornOps=set AMX_GW_SESSION_REQ_TYPE "READ"
AdornOps=set AMX_GW_EndPointRequest "Token"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/020.SNMEToSM]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_Session_Req_Type,sessionRequest.actionType.CData,""
NMEToStructuredNMEMap=AMX_GW_EndPointRequest,sessionRequest.endPointRequest.CData,""
NMEToStructuredNMEMap=AMX_GW_ACCESS_TOKEN_String,sessionRequest.sessionInfo.access_token.CData,""
NMEToStructuredNMEMap=AMX_GW_DeviceIpAddressString,ipAddress.CData,0.0.0.0
NMEToStructuredNMEMap=AMX_GW_DestinationPortInteger,port.CData,0000
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager]

ClassName=com.hp.usage.nme.rpc.client.NMERPCClientRule
CommunicationErrorRuleChain=801.ErrorSMCommunication
DecodeAttributes=SSO_CORP:SessionResponse,sessionResponse
EncodeAttribute=sessionRequest
ErrorCodeAttribute=AMX_GW_ErrorCode
ErrorRuleChain=803.ErrorSMNoConnection
MessageType=MessageSesReq
NMERPCClientAdapter=SessionManager
ResponseRuleChain=035.SessionManagerLookupResponse
RootNMEType=SSO_CORP:Body
Router=SMServerPrimary
Router=SMServerSecondary
TimeoutRuleChain=802.ErrorSMTimeOut
TryNextConnectionOnError=true
TryNextConnectionOnTimeout=true
UseAsynchRequest=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=010.SessionManagerResult
RuleNames=020.SaveSessionInDB
RuleNames=030.InvokeAuthenticateBySAML


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=:::::: 035. Session Manager Response Success :::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/010.SessionManagerResult]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
SNMEType=SSO_CORP:Body
StructuredNMEToNMEMap=port.CData,AMX_GW_DestinationPortInteger
StructuredNMEToNMEMap=ipAddress.CData,AMX_GW_DeviceIpAddressString
StructuredNMEToNMEMap=sessionResponse.responseCode.CData,AMX_GW_ERROR
StructuredNMEToNMEMap=sessionResponse.responseMessage.CData,AMX_GW_ERROR_MESSAGE
StructuredNMEToNMEMap=sessionResponse.sessionInfo.userId.CData,AMX_GW_Loginname,-1111
StructuredNMEToNMEMap=sessionResponse.sessionInfo.clientid.CData,AMX_GW_ClientID,-1111
StructuredNMEToNMEMap=sessionResponse.sessionInfo.requestAuthorize.state.CData,AMX_GW_STATE,-1111
StructuredNMEToNMEMap=sessionResponse.sessionInfo.requestAuthorize.redirect_uri.CData,AMX_GW_RedirectURI,-1111
StructuredNMEToNMEMap=sessionResponse.sessionInfo.requestAuthorize.nonce.CData,AMX_GW_NONCE,-1111
StructuredNMEToNMEMap=sessionResponse.sessionInfo.responseAuthorize.code.CData,AMX_GW_CODE,-1111
StructuredNMEToNMEMap=sessionResponse.sessionInfo.responseToken.access_token.CData,AMX_GW_AccessToken,-1111
StructuredNMEToNMEMap=sessionResponse.sessionInfo.responseToken.refresh_token.CData,AMX_GW_REFRESH_TOKEN,-1111
StructuredNMEToNMEMap=sessionResponse.sessionInfo.responseToken.expires_in.CData,GW_OutExpiresInString,-1111
StructuredNMEToNMEMap=sessionResponse.sessionInfo.responseToken.idToken.session_id.CData,AMX_GW_SESSIONID,-1111
StructuredNMEToNMEMap=sessionResponse.sessionInfo.endTimeTokenId.CData,AMX_IM_REQA_ENDTIME,-1111
StructuredNMEToNMEMap=sessionResponse.sessionInfo.requestAuthorize.client_issuer.CData,AMX_GW_CLIENT_ID_ISSUER,UNICLARO


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.SetParams
RuleNames=000.Log
RuleNames=020.ConvertSessionInfoToBinary
RuleNames=030.CreateOrUpdate


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=:::::: 010. Session Manager Before DB  :::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/010.SetParams]

AdornOps=setifnull AMX_GW_SAMLAUTHNID none
AdornOps=setifnull AMX_GW_SAMLASSERTION none
AdornOps=copy AMX_GW_Loginname AMX_GW_USERID
AdornOps=copy AMX_GW_Loginname AMX_GW_LOGINNAME
AdornOps=copy AMX_GW_ClientID  AMX_GW_CLIENTID
AdornOps=copy AMX_GW_AccessToken AMX_GW_ACCESS_TOKEN
AdornOps=+ GW_OutExpiresInString 000 GW_OutExpiresInString
AdornOps=copy GW_OutExpiresInString AMX_GW_FinishTimeLong
AdornOps=copy AMX_GW_FinishTimeLong AMX_GW_ENDTIME
AdornOps=copy GW_OutExpiresInString AMX_GW_ENDTIMETOKENID
AdornOps=set AMX_GW_CONTEXT "Token"
AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set GW_FlagAuthnInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/020.ConvertSessionInfoToBinary]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.CopySessionInfo
RuleNames=020.ConvertSessionInfoToBinary
RuleNames=000.CopyToDB


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/020.ConvertSessionInfoToBinary/000.CopyToDB]

AdornOps=copy AMX_GW_SESSIONINFO_BIN AMX_GW_SESSIONINFO
AdornOps=set AMX_GW_SESSIONINFO NOCUPO
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/020.ConvertSessionInfoToBinary/010.CopySessionInfo]

AdornOps=copy sessionResponse.sessionInfo sessionInfo
ClassName=com.hp.usage.nme.rules.SNMEAdornmentRule
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/020.ConvertSessionInfoToBinary/020.ConvertSessionInfoToBinary]

BinaryAttribute=AMX_GW_SESSIONINFO_BIN
ClassName=com.hp.usage.nme.rules.SNMEBinaryConversionRule
ConversionMode=snme2bin
EncodeAttribute=sessionInfo
RootNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/030.CreateOrUpdate]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.Log
RuleNames=010.LookupSessionExist
RuleNames=000.Log
RuleNames=030.UpdateSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/030.CreateOrUpdate/000.Log]

Attributes=AMX_GW_SESSIONID
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=:::::: AfterLookup :::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/030.CreateOrUpdate/010.Log]

Attributes=AMX_GW_SESSIONID
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=:::::: BeforeLookup :::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/030.CreateOrUpdate/010.LookupSessionExist]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
LogInvalidSession=false
MapAttributes=AMX_GW_SESSIONID,AMX_GW_SESSIONID_TABLE
NativeCondition=ByAuthnId
NotExistsErrorRuleChain=107.CreateSessionInDB
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/030.CreateOrUpdate/030.UpdateSession]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.TimeOfSession
RuleNames=200.UpdateSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/030.CreateOrUpdate/030.UpdateSession/100.TimeOfSession]

AdornOps=setsystime AMX_GW_StartTimeLong
AdornOps=copy AMX_GW_StartTimeLong AMX_GW_STARTTIME
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/020.SaveSessionInDB/030.CreateOrUpdate/030.UpdateSession/200.UpdateSession]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=840.ErrorInDB
MapAttributes=AMX_GW_SESSIONID,AMX_GW_SESSIONID
MapAttributes=AMX_GW_CLIENTID,AMX_GW_CLIENTID
MapAttributes=AMX_GW_CODE,AMX_GW_CODE
MapAttributes=AMX_GW_LOGINNAME,AMX_GW_LOGINNAME
MapAttributes=AMX_GW_ACCESS_TOKEN,AMX_GW_ACCESS_TOKEN
MapAttributes=AMX_GW_SESSIONINFO
MapAttributes=AMX_GW_STARTTIME
MapAttributes=AMX_GW_ENDTIME
MapAttributes=AMX_GW_ENDTIMETOKENID
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/030.InvokeAuthenticateBySAML]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200.AuthenticateBySAML
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/Copy of 020.SaveSessionInDB]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.SetParams
RuleNames=000.Log
RuleNames=020.ConvertSessionInfoToBinary
RuleNames=030.CreateOrUpdate


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/Copy of 020.SaveSessionInDB/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=:::::: 010. Session Manager Before DB  :::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/Copy of 020.SaveSessionInDB/010.SetParams]

AdornOps=setifnull AMX_GW_SAMLAUTHNID none
AdornOps=setifnull AMX_GW_SAMLASSERTION none
AdornOps=copy AMX_GW_Loginname AMX_GW_USERID
AdornOps=copy AMX_GW_Loginname AMX_GW_LOGINNAME
AdornOps=copy AMX_GW_ClientID  AMX_GW_CLIENTID
AdornOps=copy AMX_GW_AccessToken AMX_GW_ACCESS_TOKEN
AdornOps=+ GW_OutExpiresInString 000 GW_OutExpiresInString
AdornOps=copy GW_OutExpiresInString AMX_GW_FinishTimeLong
AdornOps=copy AMX_GW_FinishTimeLong AMX_GW_ENDTIME
AdornOps=copy GW_OutExpiresInString AMX_GW_ENDTIMETOKENID
AdornOps=set AMX_GW_CONTEXT "Token"
AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set GW_FlagAuthnInteger 1
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/Copy of 020.SaveSessionInDB/020.ConvertSessionInfoToBinary]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.CopySessionInfo
RuleNames=020.ConvertSessionInfoToBinary
RuleNames=000.CopyToDB


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/Copy of 020.SaveSessionInDB/020.ConvertSessionInfoToBinary/000.CopyToDB]

AdornOps=copy AMX_GW_SESSIONINFO_BIN AMX_GW_SESSIONINFO
AdornOps=set AMX_GW_SESSIONINFO NOCUPO
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/Copy of 020.SaveSessionInDB/020.ConvertSessionInfoToBinary/010.CopySessionInfo]

AdornOps=copy sessionResponse.sessionInfo sessionInfo
ClassName=com.hp.usage.nme.rules.SNMEAdornmentRule
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/Copy of 020.SaveSessionInDB/020.ConvertSessionInfoToBinary/020.ConvertSessionInfoToBinary]

BinaryAttribute=AMX_GW_SESSIONINFO_BIN
ClassName=com.hp.usage.nme.rules.SNMEBinaryConversionRule
ConversionMode=snme2bin
EncodeAttribute=sessionInfo
RootNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/Copy of 020.SaveSessionInDB/030.CreateOrUpdate]

001.CreateRecord=100.SetStartTime
001.CreateRecord=200.Create
002.UpdateRecord=300.Update
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=GW_FlagAuthnInteger,=,1
Conditions=GW_FlagAuthnInteger,=,2
TrueRuleChain=001.CreateRecord
TrueRuleChain=002.UpdateRecord


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/Copy of 020.SaveSessionInDB/030.CreateOrUpdate/100.SetStartTime]

AdornOps=setsystime AMX_GW_StartTimeLong
AdornOps=copy AMX_GW_StartTimeLong AMX_GW_STARTTIME
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/Copy of 020.SaveSessionInDB/030.CreateOrUpdate/200.Create]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=false
DefaultErrorRuleChain=840.ErrorInDB
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/035.SessionManagerLookupResponse/Copy of 020.SaveSessionInDB/030.CreateOrUpdate/300.Update]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=840.ErrorInDB
MapAttributes=AMX_GW_ClientString
MapAttributes=AMX_GW_LoginNameString
MapAttributes=AMX_GW_SamlAuthnIdString
MapAttributes=AMX_GW_ACCESS_TOKEN
MapAttributes=AMX_GW_StartTimeLong
MapAttributes=AMX_GW_FinishTimeLong
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/801.ErrorSMCommunication]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.SetParams
RuleNames=020.TraceError


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/801.ErrorSMCommunication/010.SetParams]

AdornOps=set AMX_GW_ERROR -30
AdornOps=set AMX_GW_ERROR_MESSAGE "Session Manager Commnunication ERROR:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/801.ErrorSMCommunication/020.TraceError]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=SESSION MANAGER ERROR:


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/802.ErrorSMTimeOut]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.SetParams
RuleNames=020.TraceError


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/802.ErrorSMTimeOut/010.SetParams]

AdornOps=set AMX_GW_ERROR -31
AdornOps=set AMX_GW_ERROR_MESSAGE "Session Manager Timeout ERROR:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/802.ErrorSMTimeOut/020.TraceError]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=SESSION MANAGER ERROR:


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/803.ErrorSMNoConnection]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.SetParams
RuleNames=020.TraceError


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/803.ErrorSMNoConnection/010.SetParams]

AdornOps=set AMX_GW_ERROR -32
AdornOps=set AMX_GW_ERROR_MESSAGE "Session Manager No Connection ERROR:"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/106.GetValuesFromSM/030.InvokeSessionManager/803.ErrorSMNoConnection/020.TraceError]

Attributes=AMX_IM_LOGIN_NAME
Attributes=AMX_IM_ERROR_MESSAGE
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=SESSION MANAGER ERROR:


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/107.CreateSessionInDB]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=100.SetStartTime
RuleNames=200.Create


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/107.CreateSessionInDB/100.SetStartTime]

AdornOps=setsystime AMX_GW_StartTimeLong
AdornOps=copy AMX_GW_StartTimeLong AMX_GW_STARTTIME
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/107.CreateSessionInDB/200.Create]

ClassName=com.hp.siu.sessionserver.rules.CreateSessionRule
ContinueAfterErrorFixed=false
DefaultErrorRuleChain=840.ErrorInDB
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/107.CreateSessionInDB/300.InvokeAuthenticateBySAML]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=200.AuthenticateBySAML
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/200.AuthenticateBySAML]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=020.SetFlagAuthn
RuleNames=010.LogBegin
RuleNames=030.SetSAMLRequest
RuleNames=040.EncodeRequest
RuleNames=050.SendHTTPRequest


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/200.AuthenticateBySAML/010.LogBegin]

Attributes=GW_FlagAuthnInteger
Attributes=AMX_GW_USERID
Attributes=AMX_GW_CLIENTID
Attributes=AMX_GW_LOGINNAME
Attributes=AMX_GW_SAMLAUTHNID
Attributes=AMX_GW_RedirectURI
Attributes=AMX_GW_STARTTIME
Attributes=AMX_GW_ENDTIME
Attributes=AMX_GW_CLIENT_ID_ISSUER
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Send Authentication Client :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/200.AuthenticateBySAML/020.SetFlagAuthn]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Expression=(GW_FlagAuthnInteger == 1) && (AMX_GW_SamlAuthnIdString == null || AMX_GW_SamlAuthnIdString == "none")
TrueRuleChain=010.ChangeFlagValue


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/200.AuthenticateBySAML/020.SetFlagAuthn/010.ChangeFlagValue]

AdornOps=set GW_FlagAuthnInteger 4
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/200.AuthenticateBySAML/030.SetSAMLRequest]

ClassName=ScriptingRule
ScriptLanguage=groovy
ScriptPath=deployment/scripting/SSO/SAMLRequest.groovy


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/200.AuthenticateBySAML/040.EncodeRequest]

AdornOps=str2bin GW_SAMLRequestString GW_SAMLRequestBinary "UTF-8"
AdornOps=encBase64 GW_SAMLRequestBinary GW_SAMLRequestString
AdornOps=set GW_OperationAttrString Authentication
AdornOps=copy AMX_GW_USERID AMX_GW_SAML_RelayStateString
AdornOps=set GW_OperationAttrString Authentication
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/200.AuthenticateBySAML/050.SendHTTPRequest]

ClassName=com.hp.usage.lookup.AsynchronousLookupRule
ConnectorName=SAMLClient
ErrorCodeAttribute=GW_HTTPClientErrorCodeString
ErrorMessageAttribute=GW_HTTPClientErrorMessageString
ErrorRuleChain=830.ErrorSentRequest
SuccessRuleChain=201.ResponseCredentialsFromSAML


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin
RuleNames=020.CheckHTTPResponse
RuleNames=030.DecodeResponse
RuleNames=040.ValidateAnswer


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/010.LogBegin]

Attributes=AMX_GW_SamlAuthnIdString
Attributes=AMX_SAML_GatewayString
Attributes=AMX_GW_SAML_ResponseString
Attributes=AMX_GW_SAML_RelayStateString
Attributes=AMX_GW_SAML_ResponseIDString
Attributes=AMX_GW_SAML_AssertionIDString
Attributes=AMX_GW_SAML_ResponseDestinationString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Return from BackEnd SAML Server Authn Req :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/020.CheckHTTPResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_SAML_GatewayString,isnot,null
TrueRuleChain=010.CopyGatewayToResponse


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/020.CheckHTTPResponse/010.CopyGatewayToResponse]

AdornOps=copy AMX_SAML_GatewayString AMX_GW_SAML_ResponseString
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/030.DecodeResponse]

AdornOps=decBase64 AMX_GW_SAML_ResponseString AMX_SAML_ResponseBinary
AdornOps=bin2str AMX_SAML_ResponseBinary AMX_GW_SAML_ResponseString "UTF-8"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_SAML_AssertionIDString,contains,null
FalseRuleChain=020.GoToSAMLCredentials
TrueRuleChain=010.SetErrors


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/010.SetErrors]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=010.SetErrors
RuleNames=020.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/010.SetErrors/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::::: Set Errors from CBL::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/010.SetErrors/010.SetErrors]

AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set GW_ErrorString -999
AdornOps=set GW_ErrorDescriptionString "InternalSystemFailed"
AdornOps=set AMX_AM_GW_ResponseHandlerString TokenResponseHandler
AdornOps=set GW_OperationAttrString Token
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/010.SetErrors/020.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin
RuleNames=020.SetValues
RuleNames=050.TypeOfRequest


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/010.LogBegin]

Attributes=AMX_GW_USERID
Attributes=AMX_GW_CLIENTID
Attributes=AMX_AM_GW_PWD_String
Attributes=AMX_GW_SamlAuthnIdString
Attributes=AMX_GW_SAML_AssertionIDString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Message SAML Authn Request :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/020.SetValues]

AdornOps=set Sender later
AdornOps=set GW_AddInfoString ""
AdornOps=set GW_CorbaErrorAttributeString ""
AdornOps=set GW_HttpErrorAttrString ""
AdornOps=set GW_PRDString 1
AdornOps=set GW_MessageString ""
AdornOps=set GW_ResponseCodeString 0
AdornOps=set GW_ReturnAttrNameInteger 0
AdornOps=set GW_ResponseCodeSuccessString 0
AdornOps=set GW_ReturnCodeSuccessInteger 0
AdornOps=set GW_ThrowExceptionFlagInteger 1
AdornOps=set GW_ReturnCodeInteger 0
AdornOps=set GW_InternalErrorString 500
AdornOps=set GW_HTTPContextMandatoryErrorString 400
AdornOps=set GW_HTTPContextLengthErrorString 411
AdornOps=set GW_HTTPCheckRetCodeInteger 1
AdornOps=set GW_FlagAuthnInteger 3
AdornOps=set GW_ErrorString 0
AdornOps=set GW_ErrorDescriptionString 0
AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set GW_SAMLRequestString must
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_SamlAuthnIdString,!=,none
FalseRuleChain=010.LookupLastLogin
TrueRuleChain=020.GoToPrepareCredentials


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/010.LookupLastLogin]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Error


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/010.LookupLastLogin/000.Error]

Attributes=AMX_GW_USERID
Attributes=AMX_GW_CLIENTID
Attributes=AMX_AM_GW_PWD_String
Attributes=AMX_GW_SamlAuthnIdString
Attributes=AMX_GW_SAML_AssertionIDString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Message SAML Authn Request :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/010.LookupLastLogin/010.LookupLastLogin]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
LogInvalidSession=false
MapAttributes=AMX_GW_ClientString,AMX_GW_ClientString
MapAttributes=AMX_GW_LoginNameString,AMX_GW_LoginNameString
MapAttributes=AMX_GW_SamlAuthnIdString,AMX_GW_SamlAuthnIdString
MapAttributes=AMX_GW_AccessTokenString,AMX_GW_AccessTokenString
MapAttributes=AMX_GW_StartTimeLong,AMX_GW_StartTimeLong
MapAttributes=AMX_GW_FinishTimeLong,AMX_GW_FinishTimeLong
NotExistsErrorRuleChain=200.AuthenticateBySAML
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.GetPassword
RuleNames=020.EncodeLoginAndPass
RuleNames=000.Log
RuleNames=030.SendCredentials


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/000.Log]

Attributes=AMX_GW_SAML_UserNameString
Attributes=AMX_GW_SAML_PasswordString
Attributes=AMX_GW_SamlAuthnIdString
Attributes=AMX_GW_SAML_ResponseIDString
Attributes=AMX_GW_SAML_AssertionIDString
Attributes=AMX_GW_SAML_ResponseDestinationString
Attributes=GW_FlagAuthnInteger
Attributes=GW_OperationAttrString
Attributes=GW_SAMLRequestString
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Before To send credential to User:::::::::
NullAlso=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/010.GetPassword]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.ConvertBinaryToSessionInfo
RuleNames=002.GetPasswordToUser
RuleNames=000.Log
RuleNames=003.DecriptPassword


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/010.GetPassword/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: AFTER DECODE SESSION INFO :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/010.GetPassword/001.ConvertBinaryToSessionInfo]

BinaryAttribute=AMX_GW_SESSIONINFO_BIN
ClassName=com.hp.usage.nme.rules.SNMEBinaryConversionRule
ConversionMode=bin2snme
DecodeAttribute=SSO_CORP:SessionInfo,sessionInfo
RootNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/010.GetPassword/002.GetPasswordToUser]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
SNMEType=SSO_CORP:Body
StructuredNMEToNMEMap=sessionInfo.user.password.CData,AMX_AM_GW_PWD_String


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/010.GetPassword/003.DecriptPassword]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.GeneratedKeys
RuleNames=002.ValidatetoCutKey
RuleNames=003.ConvertIntoBytes
RuleNames=000.Log
RuleNames=004.DecriptAES256


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/010.GetPassword/003.DecriptPassword/000.Log]

Attributes=AMX_AM_GW_PWD_String
Attributes=AMX_AM_GW_PWD_DECRIPT_String
Attributes=keyString
Attributes=keyBinary
Attributes=EncodeBinary
Attributes=keyLengthInteger
Attributes=StringValueToBin
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: DECRIPT PASSWORD:::::::::
NullAlso=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/010.GetPassword/003.DecriptPassword/001.GeneratedKeys]

AdornOps=set keyPKString fn17enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD89Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUjIiEg
AdornOps=decBase64 keyPKString keyBinary
AdornOps=bin2str keyBinary keyString "UTF-8"
AdornOps=length keyString keyLengthInteger
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/010.GetPassword/003.DecriptPassword/002.ValidatetoCutKey]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=keyLengthInteger,>,32
TrueRuleChain=1.cutKey


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/010.GetPassword/003.DecriptPassword/002.ValidatetoCutKey/1.cutKey]

AdornOps=substr 0 32 keyString keyString
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/010.GetPassword/003.DecriptPassword/003.ConvertIntoBytes]

AdornOps=str2bin keyString keyBinary "UTF-8"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/010.GetPassword/003.DecriptPassword/004.DecriptAES256]

AdornOps=decBase64 AMX_AM_GW_PWD_String EncodeBinary
AdornOps=decrypt "AES" keyBinary - EncodeBinary  EncodeBinary_tmp
AdornOps=bin2str EncodeBinary_tmp AMX_AM_GW_PWD_DECRIPT_String  "UTF-8"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/020.EncodeLoginAndPass]

AdornOps=str2bin AMX_GW_LOGINNAME AMX_GW_LoginNameBinary "UTF-8"
AdornOps=encBase64 AMX_GW_LoginNameBinary AMX_GW_SAML_UserNameString
AdornOps=str2bin AMX_AM_GW_PWD_DECRIPT_String AMX_AM_GW_PWD_Binary "UTF-8"
AdornOps=encBase64 AMX_AM_GW_PWD_Binary AMX_GW_SAML_PasswordString
AdornOps=set GW_OperationAttrString Authentication
AdornOps=copy AMX_GW_USERID AMX_GW_SAML_RelayStateString
AdornOps=set GW_FlagAuthnInteger 4
AdornOps=copy AMX_GW_SAML_ResponseIDString AMX_GW_SamlAuthnIdString
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/201.ResponseCredentialsFromSAML/040.ValidateAnswer/020.GoToSAMLCredentials/050.TypeOfRequest/020.GoToPrepareCredentials/030.SendCredentials]

ClassName=com.hp.usage.lookup.AsynchronousLookupRule
ConnectorName=SAMLClient
ErrorCodeAttribute=GW_HTTPClientErrorCodeString
ErrorMessageAttribute=GW_HTTPClientErrorMessageString
ErrorRuleChain=830.ErrorSentRequest
SuccessRuleChain=202.ResponseAuthFromSAML


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.DecodeResponse
RuleNames=000.Log
RuleNames=020.CheckResponse


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::: Success go To Credentials ::::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/010.DecodeResponse]

AdornOps=decBase64 AMX_GW_SAML_ResponseString AMX_SAML_ResponseBinary
AdornOps=bin2str AMX_SAML_ResponseBinary AMX_GW_SAML_ResponseString "UTF-8"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_SAML_ResponseString,contains,"saml:Assertion"
FalseRuleChain=ParseError
TrueRuleChain=SendResponse


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/ParseError]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.GetError
RuleNames=000.Log
RuleNames=020.SetErrors
RuleNames=030.EncodeError
RuleNames=040.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/ParseError/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::::: Set Errors from credentials user :::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/ParseError/010.GetError]

ClassName=com.hp.siu.collector.rules.SplitStringRule
DstAttribute=GW_ErrorDescriptionString
LeftSplitString=status:
RightSplitString=/>
SrcAttribute=AMX_GW_SAML_ResponseString


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/ParseError/020.SetErrors]

AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set AMX_AM_GW_ResponseHandlerString "TokenResponseHandler"
AdornOps=set GW_ErrorString -999
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/ParseError/030.EncodeError]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=GW_ErrorString,responseToken.error.CData
NMEToStructuredNMEMap=GW_ErrorDescriptionString,responseToken.error_description.CData
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/ParseError/040.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.ConvertAssertionToBinary
RuleNames=020.GetAssertion
RuleNames=030.UpdateDB
RuleNames=000.Log
RuleNames=040.RequestJWT
RuleNames=050.CopyResponseSNME
RuleNames=060.SendAnswerToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/000.Log]

Attributes=AMX_GW_SAMLAUTHNID
Attributes=AMX_GW_SAMLASSERTION
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::: Success contain asertions ::::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/010.ConvertAssertionToBinary]

AdornOps=str2bin AMX_GW_SAMLASSERTION AMX_GW_SAMLASSERTION_BIN "UTF-8"
AdornOps=encBase64 AMX_GW_SAMLASSERTION_BIN AMX_GW_SAMLASSERTION
AdornOps=copy AMX_GW_SamlAuthnIdString AMX_GW_SAMLAUTHNID
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/020.GetAssertion]

ClassName=com.hp.siu.collector.rules.SplitStringRule
DstAttribute=AMX_GW_SAMLASSERTION
LeftSplitString=</samlp:Status>
RightSplitString=</samlp:Response>
SrcAttribute=AMX_GW_SAML_ResponseString


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/030.UpdateDB]

ClassName=com.hp.siu.sessionserver.rules.UpdateSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=840.ErrorInDB
MapAttributes=AMX_GW_SAMLAUTHNID
MapAttributes=AMX_GW_SAMLASSERTION
NativeCondition=ByAuthnId
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.SetJsonDestinationAttr
RuleNames=020.EncodeJson
RuleNames=030.GetJsonString
RuleNames=040.CleanJson
RuleNames=045.CheckForClientSecret
RuleNames=050.EncriptJsonHeader
RuleNames=060.EncriptJsonPayload
RuleNames=000.Log
RuleNames=070.EncriptJsonSign
RuleNames=080.SetJWT
RuleNames=090.ClearIdTokenSnme
RuleNames=999.Log


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=::::: Start Encode TokenID:


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/010.SetJsonDestinationAttr]

ClassName=NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_JWT,sessionInfo.responseToken.id_token.CData,init_json_field
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/020.EncodeJson]

ClassName=StringCodecRule
DestinationAttribute=sessionInfo.responseToken.id_token.CData
RootElement=idToken
SNMENamespace=SSO_CORP
SourceAttribute=sessionInfo.responseToken.idToken
TreatAsJSON=true
XMLSchemaDefinitionFile=${CONNECTOR_TPCCLIENT_OID_JSONRESPONSE_XSDFILE}


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/030.GetJsonString]

ClassName=NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
SNMEType=SSO_CORP:Body
StructuredNMEToNMEMap=sessionInfo.responseToken.id_token.CData,AMX_GW_JSON_PAYLOAD_STR,json_format
StructuredNMEToNMEMap=sessionInfo.client.clientsecret.CData,AMX_GW_CLIENT_CLIENTSECRET


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/040.CleanJson]

AdornOps=substr 11 length-1 AMX_GW_JSON_PAYLOAD_STR AMX_GW_JSON_PAYLOAD_STR
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/045.CheckForClientSecret]

ClassName=ConditionalRule
Conditions=AMX_GW_CLIENT_CLIENTSECRET,=,""
FalseRuleChain=020.SetAlgHS256
TrueRuleChain=010.SetAlgNone


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/045.CheckForClientSecret/010.SetAlgNone]

AdornOps=set AMX_GW_JSON_HEADER_STR {|alg|:|none|,|typ|:|JWT|}
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/045.CheckForClientSecret/020.SetAlgHS256]

AdornOps=set AMX_GW_JSON_HEADER_STR {|alg|:|HS256|,|typ|:|JWT|}
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/050.EncriptJsonHeader]

AdornOps=replace "|" """ AMX_GW_JSON_HEADER_STR AMX_GW_JSON_HEADER_STR
AdornOps=str2bin AMX_GW_JSON_HEADER_STR AMX_GW_JSON_HEADER_BIN
AdornOps=encBase64 AMX_GW_JSON_HEADER_BIN AMX_GW_JSON_HEADER
AdornOps=replace "=" "" AMX_GW_JSON_HEADER AMX_GW_JSON_HEADER
AdornOps=replace "+" "-" AMX_GW_JSON_HEADER AMX_GW_JSON_HEADER
AdornOps=replace "/" "_" AMX_GW_JSON_HEADER AMX_GW_JSON_HEADER
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/060.EncriptJsonPayload]

AdornOps=str2bin AMX_GW_JSON_PAYLOAD_STR AMX_GW_JSON_PAYLOAD_BIN
AdornOps=encBase64 AMX_GW_JSON_PAYLOAD_BIN AMX_GW_JSON_PAYLOAD
AdornOps=replace "=" "" AMX_GW_JSON_PAYLOAD AMX_GW_JSON_PAYLOAD
AdornOps=replace "+" "-" AMX_GW_JSON_PAYLOAD AMX_GW_JSON_PAYLOAD
AdornOps=replace "/" "_" AMX_GW_JSON_PAYLOAD AMX_GW_JSON_PAYLOAD
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/070.EncriptJsonSign]

ClassName=ConditionalRule
Conditions=AMX_GW_CLIENT_CLIENTSECRET,=,""
FalseRuleChain=020.JWTSIGNED
TrueRuleChain=010.JWTnotSIGNED


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/070.EncriptJsonSign/010.JWTnotSIGNED]

AdornOps=+ AMX_GW_JSON_HEADER . AMX_GW_JSON_SIGN_STR
AdornOps=+ AMX_GW_JSON_SIGN_STR AMX_GW_JSON_PAYLOAD AMX_GW_JWT
AdornOps=+ AMX_GW_JWT . AMX_GW_JWT
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/070.EncriptJsonSign/020.JWTSIGNED]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=020.JWTSIGNED
RuleNames=000.Log1


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/070.EncriptJsonSign/020.JWTSIGNED/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=:::::::JWTSIGNED ::::::::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/070.EncriptJsonSign/020.JWTSIGNED/000.Log1]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=:::::::JWTSIGNED PART2::::::::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/070.EncriptJsonSign/020.JWTSIGNED/020.JWTSIGNED]

AdornOps=copy AMX_GW_CLIENT_CLIENTSECRET AMX_GW_JWT_KEY_STR
AdornOps=str2bin AMX_GW_JWT_KEY_STR AMX_GW_JWT_KEY_BIN
AdornOps=+ AMX_GW_JSON_HEADER . AMX_GW_JSON_SIGN_STR
AdornOps=+ AMX_GW_JSON_SIGN_STR AMX_GW_JSON_PAYLOAD AMX_GW_JSON_SIGN_STR
AdornOps=str2bin AMX_GW_JSON_SIGN_STR AMX_GW_JSON_SIGN_BIN
AdornOps=hMac "HmacSHA256" AMX_GW_JWT_KEY_BIN AMX_GW_JSON_SIGN_BIN AMX_GW_JSON_SIGN_BIN
AdornOps=encBase64 AMX_GW_JSON_SIGN_BIN AMX_GW_JSON_SIGN
AdornOps=replace "=" "" AMX_GW_JSON_SIGN AMX_GW_JSON_SIGN
AdornOps=replace "+" "-" AMX_GW_JSON_SIGN AMX_GW_JSON_SIGN
AdornOps=replace "/" "_" AMX_GW_JSON_SIGN AMX_GW_JSON_SIGN
AdornOps=+ AMX_GW_JSON_SIGN_STR . AMX_GW_JWT
AdornOps=+ AMX_GW_JWT AMX_GW_JSON_SIGN AMX_GW_JWT
AdornOps=copy AMX_GW_JWT GW_OutIDTokenString
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/070.EncriptJsonSign/020.JWTSIGNED/030.JWTSIGNED]

AdornOps=replace "+" "-" AMX_IM_JSON_SIGN AMX_IM_JSON_SIGN
AdornOps=replace "/" "_" AMX_IM_JSON_SIGN AMX_IM_JSON_SIGN
AdornOps=+ AMX_GW_JSON_SIGN_STR . AMX_GW_JWT
AdornOps=+ AMX_IM_JWT AMX_IM_JSON_SIGN AMX_GW_JWT
ClassName=com.hp.siu.collector.rules.AdornmentRule
Copy of AdornOps=copy AMX_GW_CLIENT_CLIENTSECRET AMX_GW_JWT_KEY_STR
Copy of AdornOps=str2bin AMX_GW_JWT_KEY_STR AMX_GW_JWT_KEY_BIN
Copy of AdornOps=+ AMX_GW_JSON_HEADER . AMX_GW_JSON_SIGN_STR
Copy of AdornOps=+ AMX_GW_JSON_SIGN_STR AMX_GW_JSON_PAYLOAD AMX_GW_JSON_SIGN_STR
Copy of AdornOps=str2bin AMX_GW_JSON_SIGN_STR AMX_GW_JSON_SIGN_BIN
Copy of AdornOps=hMac "HmacSHA256" AMX_GW_JWT_KEY_BIN AMX_GW_JSON_SIGN_BIN AMX_GW_JSON_SIGN_BIN
Copy of AdornOps=encBase64 AMX_GW_JSON_SIGN_BIN AMX_GW_JSON_SIGN
Copy of AdornOps=replace "=" "" AMX_IM_JSON_SIGN AMX_IM_JSON_SIGN
Copy of AdornOps=replace "+" "-" AMX_IM_JSON_SIGN AMX_IM_JSON_SIGN
Copy of AdornOps=replace "/" "_" AMX_IM_JSON_SIGN AMX_IM_JSON_SIGN
Copy of AdornOps=+ AMX_GW_JSON_SIGN_STR . AMX_GW_JWT
Copy of AdornOps=+ AMX_IM_JWT AMX_IM_JSON_SIGN AMX_GW_JWT


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/080.SetJWT]

ClassName=NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_JWT,sessionInfo.responseToken.id_token.CData,init_json_field
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/090.ClearIdTokenSnme]

AdornOps=clear sessionInfo.responseToken.idToken
ClassName=SNMEAdornmentRule
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/040.RequestJWT/999.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=:::::::End TokenID ::::::::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/050.CopyResponseSNME]

AdornOps=copy sessionInfo.responseToken responseToken
ClassName=com.hp.usage.nme.rules.SNMEAdornmentRule
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/060.SendAnswerToClient]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=010.SetParams
RuleNames=020.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/060.SendAnswerToClient/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::::: PrepareToSendAnswer::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/060.SendAnswerToClient/010.SetParams]

AdornOps=set GW_ErrorString 0
AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set AMX_AM_GW_ResponseHandlerString "TokenResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/202.ResponseAuthFromSAML/020.CheckResponse/SendResponse/060.SendAnswerToClient/020.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin
RuleNames=020.SetResponseHandler
RuleNames=030.Initialize
RuleNames=040.CheckParameters
RuleNames=050.DecodeJWT
RuleNames=060.LookupLastLogin
RuleNames=070.EncodeRequest
RuleNames=000.LogEnd
RuleNames=080.SendHTTPRequest


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/000.LogEnd]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Message Revoke Response :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/010.LogBegin]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Message Revoke Request :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/020.SetResponseHandler]

AddInfoAttributeName=GW_AddInfoString
ClassName=com.hp.usage.throttling.ResponseHandlerRule
CorbaErrorAttributeName=GW_CorbaErrorAttributeString
ExceptionResponseRuleName=820.ErrorExceptionFlow
FaultResponseName=010.DoNothing
HttpErrorAttributeName=GW_HttpErrorAttrString
IUMPRDAttributeName=GW_PRDString
MessageAttributeName=GW_MessageString
NormalResponseRuleName=010.DoNothing
OtherExceptions=Mandatory parameter,GW_ResponseCodeString,GW_ReturnAttrNameInteger
OtherExceptions=Length check,GW_ResponseCodeString,GW_ReturnAttrNameInteger
OtherExceptions=RuleException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=IMP_LIMIT,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=TRANSIENT,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=OutOfBoundsException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=ConfigurationException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=NullPointerException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=OutOfMemoryException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=NamingException,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=SCPInternal,GW_InternalErrorString,GW_ReturnAttrNameInteger
OtherExceptions=IUMInternal,GW_InternalErrorString,GW_ReturnAttrNameInteger
PRDAttributeName=GW_PRDString
ResponseAttributeName=GW_ResponseCodeString
ReturnAttributeName=GW_ReturnAttrNameInteger
SCPErrorAttributeName=GW_SCPErrorAttrString
SCPPRDAttributeName=GW_SCPPRAttrString
SuccessResponseValue=GW_ResponseCodeSuccessString
SuccessReturnValue=GW_ReturnCodeSuccessInteger
ThrowExceptionFlagAttribute=GW_ThrowExceptionFlagInteger
ThrtBucketIDAttributeName=GW_ThrtBucketIDLong
TimeAttributeName=GW_TimeAttrString


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/030.Initialize]

AdornOps=set Sender later
AdornOps=set GW_AddInfoString ""
AdornOps=set GW_CorbaErrorAttributeString ""
AdornOps=set GW_HttpErrorAttrString ""
AdornOps=set GW_PRDString 1
AdornOps=set GW_MessageString ""
AdornOps=set GW_ResponseCodeString 0
AdornOps=set GW_ReturnAttrNameInteger 0
AdornOps=set GW_ResponseCodeSuccessString 0
AdornOps=set GW_ReturnCodeSuccessInteger 0
AdornOps=set GW_ThrowExceptionFlagInteger 1
AdornOps=set GW_ReturnCodeInteger 0
AdornOps=set GW_InternalErrorString 500
AdornOps=set GW_HTTPContextMandatoryErrorString 400
AdornOps=set GW_HTTPContextLengthErrorString 411
AdornOps=set GW_HTTPCheckRetCodeInteger 1
AdornOps=set GW_FlagAuthnInteger 0
AdornOps=set GW_ErrorString 0
AdornOps=set GW_ErrorDescriptionString 0
AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set AMX_AM_GW_ResponseHandlerString "RevokeResponseHandler"
AdornOps=set AMX_GW_EXITFLAG 0
AdornOps=set GW_OperationAttrString Revoke
AdornOps=set AMX_GW_ContentTypeString "application/json"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/040.CheckParameters]

AddInfoNMEAttrName=GW_AddInfoString
AttributeCheck=AMX_GW_TOKENID,y
ClassName=com.hp.usage.throttling.NMEAttributesValidationRule
LengthCheckResCodeAttrName=GW_HTTPContextLengthErrorString
LengthCheckRetCodeAttrName=GW_HTTPCheckRetCodeInteger
LookupFailResCodeAttrName=GW_HTTPContextMandatoryErrorString
LookupFailRetCodeAttrName=GW_HTTPCheckRetCodeInteger
MandOptCheckResCodeAttrName=GW_HTTPContextMandatoryErrorString
MandOptCheckRetCodeAttrName=GW_HTTPCheckRetCodeInteger
ResCodeNMEAttrName=GW_ResponseCodeString
RetCodeNMEAttrName=GW_ReturnCodeInteger


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/050.DecodeJWT]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=020.SplitToken1
RuleNames=030.Decode64
RuleNames=000.Log
RuleNames=040.SplitSessionID
RuleNames=000.Log1
RuleNames=050.SetValues


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/050.DecodeJWT/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=:::::: DECODE JWT :::::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/050.DecodeJWT/000.Log1]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=INFO
Message=:::::: AFTER SPLIT:::::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/050.DecodeJWT/020.SplitToken1]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
DestinationAttribute=AMX_GW_JWT
DestinationAttribute=AMX_GW_JWT_PAYLOAD
DestinationAttribute=AMX_GW_JWT_HEADER
Operation=split
RegExPattern=(.*)\.(.*)\.(.*)
SourceAttribute=AMX_GW_TOKENID


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/050.DecodeJWT/030.Decode64]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LenghtPayload
RuleNames=020.CheckLenght
RuleNames=030.Decode64


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/050.DecodeJWT/030.Decode64/010.LenghtPayload]

AdornOps=length AMX_GW_JWT_PAYLOAD AMX_GW_JWT_PAYLOAD_INT
AdornOps=% AMX_GW_JWT_PAYLOAD_INT 4 AMX_GW_JWT_PAYLOAD_INT
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/050.DecodeJWT/030.Decode64/020.CheckLenght]

001.AddValueOne=AddValue
002.AddValueTwo=AddValueTwo
ClassName=com.hp.siu.collector.rules.SwitchConditionRule
Conditions=AMX_GW_JWT_PAYLOAD_INT,=,3
Conditions=AMX_GW_JWT_PAYLOAD_INT,=,2
TrueRuleChain=001.AddValueOne
TrueRuleChain=002.AddValueTwo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/050.DecodeJWT/030.Decode64/020.CheckLenght/AddValue]

AdornOps=+ AMX_GW_JWT_PAYLOAD = AMX_GW_JWT_PAYLOAD
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/050.DecodeJWT/030.Decode64/020.CheckLenght/AddValueTwo]

AdornOps=+ AMX_GW_JWT_PAYLOAD == AMX_GW_JWT_PAYLOAD
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/050.DecodeJWT/030.Decode64/030.Decode64]

AdornOps=decBase64 AMX_GW_JWT_PAYLOAD AMX_GW_BinaryJWT
AdornOps=bin2str AMX_GW_BinaryJWT AMX_GW_JWT_STR "UTF-8"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/050.DecodeJWT/040.SplitSessionID]

ClassName=com.hp.siu.collector.rules.PerlRegExStringRule
DestinationAttribute=AMX_GW_JWT
DestinationAttribute=AMX_GW_JWT_PAYLOAD
DestinationAttribute=AMX_GW_JWT_HEADER
Operation=split
RegExPattern=(.*)"session_id":"(.*)",(.*)
SourceAttribute=AMX_GW_JWT_STR


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/050.DecodeJWT/050.SetValues]

AdornOps=copy AMX_GW_JWT_PAYLOAD AMX_GW_SESSIONID
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/060.LookupLastLogin]

ClassName=com.hp.siu.sessionserver.rules.LookupSessionRule
ContinueAfterErrorFixed=true
LogInvalidSession=false
MapAttributes=AMX_GW_SESSIONID,AMX_GW_SESSIONID
MapAttributes=AMX_GW_SAMLASSERTION,AMX_GW_SAMLASSERTION
MapAttributes=AMX_GW_ACCESS_TOKEN,AMX_GW_ACCESS_TOKEN
MapAttributes=AMX_GW_SAMLAUTHNID,AMX_GW_SAMLAUTHNID
MapAttributes=AMX_GW_CLIENTID,AMX_GW_CLIENTID
NativeCondition=BySessionID
NotExistsErrorRuleChain=850.ErrorInvalidTokenID
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/070.EncodeRequest]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=AMX_GW_TOKEN_TYPE,requestOID.requestRevoke.token_type.CData
NMEToStructuredNMEMap=AMX_GW_ACCESS_TOKEN,requestOID.requestRevoke.token.CData
SNMEType=SSO_CORP:Body


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/300.RevokeRequest/080.SendHTTPRequest]

ClassName=com.hp.usage.lookup.AsynchronousLookupRule
ConnectorName=OIDClient
ErrorCodeAttribute=GW_HTTPClientErrorCodeString
ErrorMessageAttribute=GW_HTTPClientErrorMessageString
ErrorRuleChain=830.ErrorSentRequest
SuccessRuleChain=301.ResponseRevokeFromOID


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/301.ResponseRevokeFromOID]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogBegin
RuleNames=020.GetResponseValues
RuleNames=030.CheckResultCode


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/301.ResponseRevokeFromOID/010.LogBegin]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::::::::Response Success Revoke :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/301.ResponseRevokeFromOID/020.GetResponseValues]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateMissingAttributeInSNME=true
CreateSNMEIfNeeded=true
SNMEType=SSO_CORP:ResponseRevoke
StructuredNMEToNMEMap=error.CData,GW_ErrorString
StructuredNMEToNMEMap=error_description.CData,GW_ErrorDescriptionString


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/301.ResponseRevokeFromOID/030.CheckResultCode]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=GW_ErrorString,=,Seccessful
FalseRuleChain=010.SetErrors
TrueRuleChain=040.PrepareToGoSAML


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/301.ResponseRevokeFromOID/030.CheckResultCode/010.SetErrors]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=010.SetErrors
RuleNames=020.DeleteSession
RuleNames=030.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/301.ResponseRevokeFromOID/030.CheckResultCode/010.SetErrors/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::::: Set Errors from Revoke::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/301.ResponseRevokeFromOID/030.CheckResultCode/010.SetErrors/010.SetErrors]

AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set AMX_AM_GW_ResponseHandlerString "RevokeResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/301.ResponseRevokeFromOID/030.CheckResultCode/010.SetErrors/020.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=840.ErrorInDB
LogInvalidSession=false
NativeCondition=BySessionID
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/301.ResponseRevokeFromOID/030.CheckResultCode/010.SetErrors/030.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/301.ResponseRevokeFromOID/030.CheckResultCode/040.PrepareToGoSAML]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=302.PrepareToLogoutSAML
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/302.PrepareToLogoutSAML]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=020.CheackValueForRequestSAML
RuleNames=030.SetSAMLRequest
RuleNames=040.SAMLRequestBinary
RuleNames=050.SendHTTPRequest
RuleNames=000.Log1


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/302.PrepareToLogoutSAML/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: PREPARE LOGOUT FOR SAML:::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/302.PrepareToLogoutSAML/000.Log1]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: AFTER GROOVY FOR SAML:::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/302.PrepareToLogoutSAML/020.CheackValueForRequestSAML]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=001.ParseValuesofAssertion
RuleNames=000.Log


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/302.PrepareToLogoutSAML/020.CheackValueForRequestSAML/000.Log]

Attributes=AMX_GW_CLIENTID
Attributes=AMX_GW_SAMLAUTHNID
Attributes=AMX_GW_CLIENT_ID_ISSUER
Attributes=AMX_GW_SAMLASSERTIONID
Attributes=AMX_GW_SAMLASSERTIONISSUEINSTANT
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: PARSE FOR SAML:::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/302.PrepareToLogoutSAML/020.CheackValueForRequestSAML/001.ParseValuesofAssertion]

AdornOps=indexof "ID=" AMX_GW_SAMLASSERTION AMX_GW_SAMLASSERTION_INT1
AdornOps=indexof "<saml:Issuer>" AMX_GW_SAMLASSERTION AMX_GW_SAMLASSERTION_INT2
AdornOps=+ AMX_GW_SAMLASSERTION_INT1 4 AMX_GW_SAMLASSERTION_INT1
AdornOps=- AMX_GW_SAMLASSERTION_INT2 52 AMX_GW_SAMLASSERTION_INT2
AdornOps=substr AMX_GW_SAMLASSERTION_INT1 AMX_GW_SAMLASSERTION_INT2 AMX_GW_SAMLASSERTION AMX_GW_SAMLASSERTIONID
AdornOps=indexof "ID=" AMX_GW_SAMLASSERTION AMX_GW_SAMLASSERTION_INT1
AdornOps=indexof "<saml:Issuer>" AMX_GW_SAMLASSERTION AMX_GW_SAMLASSERTION_INT2
AdornOps=+ AMX_GW_SAMLASSERTION_INT1 70 AMX_GW_SAMLASSERTION_INT1
AdornOps=- AMX_GW_SAMLASSERTION_INT2 2 AMX_GW_SAMLASSERTION_INT2
AdornOps=substr AMX_GW_SAMLASSERTION_INT1 AMX_GW_SAMLASSERTION_INT2 AMX_GW_SAMLASSERTION AMX_GW_SAMLASSERTIONISSUEINSTANT
AdornOps=indexof "aud" AMX_GW_JWT AMX_GW_SAMLASSERTION_INT1
AdornOps=indexof "auth_time" AMX_GW_JWT AMX_GW_SAMLASSERTION_INT2
AdornOps=set GW_OperationAttrString Logout
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/302.PrepareToLogoutSAML/030.SetSAMLRequest]

ClassName=ScriptingRule
ScriptLanguage=groovy
ScriptPath=deployment/scripting/SSO/LogoutRequest.groovy


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/302.PrepareToLogoutSAML/040.SAMLRequestBinary]

AdornOps=str2bin GW_SAMLRequestString GW_SAMLRequestBinary "UTF-8"
AdornOps=encBase64 GW_SAMLRequestBinary GW_SAMLRequestString
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/302.PrepareToLogoutSAML/050.SendHTTPRequest]

ClassName=com.hp.usage.lookup.AsynchronousLookupRule
ConnectorName=SAMLClient
ErrorCodeAttribute=GW_HTTPClientErrorCodeString
ErrorMessageAttribute=GW_HTTPClientErrorMessageString
ErrorRuleChain=830.ErrorSentRequest
SuccessRuleChain=303.ResponseLogoutFromSAML


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.LogBegin
RuleNames=005.CutResponse
RuleNames=010.DecodeResponse
RuleNames=006.LogCut
RuleNames=015.CheckResponse


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/000.LogBegin]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: AFTER Request Logout :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/005.CutResponse]

AdornOps=substr 0 656 AMX_GW_SAML_ResponseString AMX_GW_SAML_ResponseString
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/006.LogCut]

Attributes=AMX_GW_SAML_ResponseString
Attributes=AMX_GW_SAMLASSERTION_1
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=::::::::: Log Check Cut Response :::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/010.DecodeResponse]

AdornOps=decBase64 AMX_GW_SAML_ResponseString AMX_SAML_ResponseBinary
AdornOps=bin2str AMX_SAML_ResponseBinary AMX_GW_SAML_ResponseString "UTF-8"
AdornOps=indexof "<samlp:StatusCode " AMX_GW_SAML_ResponseString AMX_GW_SAMLASSERTION_INT1
AdornOps=indexof "</samlp:StatusCode>" AMX_GW_SAML_ResponseString AMX_GW_SAMLASSERTION_INT2
AdornOps=+ AMX_GW_SAMLASSERTION_INT1 42 AMX_GW_SAMLASSERTION_INT1
AdornOps=substr AMX_GW_SAMLASSERTION_INT1 AMX_GW_SAMLASSERTION_INT2 AMX_GW_SAML_ResponseString AMX_GW_SAMLASSERTION_1
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse]

ClassName=com.hp.siu.collector.rules.ConditionalRule
Conditions=AMX_GW_SAML_ResponseString,contains,"status:Success"
FalseRuleChain=ParseError
TrueRuleChain=SendResponse


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse/ParseError]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=010.SetErrors
RuleNames=030.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse/ParseError/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::::: Set Errors from Revoke::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse/ParseError/010.SetErrors]

AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set AMX_AM_GW_ResponseHandlerString "RevokeResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse/ParseError/030.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse/SendResponse]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=010.DeleteSession
RuleNames=020.SendAnswerToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse/SendResponse/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::: Success Logout::::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse/SendResponse/010.DeleteSession]

ClassName=com.hp.siu.sessionserver.rules.DeleteSessionRule
ContinueAfterErrorFixed=true
DefaultErrorRuleChain=840.ErrorInDB
LogInvalidSession=false
NativeCondition=BySessionID
SessionStore=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse/SendResponse/020.SendAnswerToClient]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=000.Log
RuleNames=010.SetParams
RuleNames=020.EncodeRequest
RuleNames=040.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse/SendResponse/020.SendAnswerToClient/000.Log]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=:::::: PrepareToSendAnswer::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse/SendResponse/020.SendAnswerToClient/010.SetParams]

AdornOps=set GW_ErrorString 0
AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set AMX_AM_GW_ResponseHandlerString "RevokeResponseHandler"
AdornOps=set GW_ErrorDescriptionString Success
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse/SendResponse/020.SendAnswerToClient/020.EncodeRequest]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=GW_ErrorDescriptionString,error.CData
NMEToStructuredNMEMap=GW_ErrorDescriptionString,error_description.CData
SNMEType=SSO_CORP:ResponseRevoke


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/303.ResponseLogoutFromSAML/015.CheckResponse/SendResponse/020.SendAnswerToClient/040.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/800.ErrorHttpProtocol]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogError
RuleNames=020.SetErrors


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/800.ErrorHttpProtocol/010.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=!!!!!!!!!! OID ERROR IN HTTP PROTOCOL !!!!!!!!!!


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/800.ErrorHttpProtocol/020.SetErrors]

AdornOps=set Sender now
AdornOps=set AMX_GW_HttpErrorCode 400
AdornOps=set AMX_GW_HttpErrorMesssage The server cannot or will not process the request due to an apparent client error
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/810.ErrorHttpContext]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogError
RuleNames=020.SetErrors


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/810.ErrorHttpContext/010.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=!!!!!!!!!! OID ERROR IN HTTP CONTEXT !!!!!!!!!!


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/810.ErrorHttpContext/020.SetErrors]

AdornOps=set Sender now
AdornOps=set AMX_GW_HttpErrorCode 400
AdornOps=set AMX_GW_HttpErrorMesssage The server cannot or will not process the request due to an apparent client error
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/820.ErrorExceptionFlow]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogError
RuleNames=020.SetErrors


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/820.ErrorExceptionFlow/010.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=!!!!!!!!!! OID ERROR IN FLOW EXCEPTION !!!!!!!!!!


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/820.ErrorExceptionFlow/020.SetErrors]

AdornOps=set Sender now
AdornOps=copy GW_ResponseCodeString AMX_GW_HttpStatusInteger
AdornOps=copy GW_AddInfoString AMX_GW_HttpErrorMesssage
AdornOps=copy GW_ResponseCodeString GW_ErrorString 
AdornOps=copy GW_AddInfoString GW_ErrorDescriptionString
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/830.ErrorSentRequest]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogError
RuleNames=020.SetErrors
RuleNames=030.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/830.ErrorSentRequest/010.LogError]

Attributes=GW_HTTPClientErrorCodeString
Attributes=GW_HTTPClientErrorMessageString
Attributes=AMX_GW_USERID
Attributes=AMX_AM_GW_ACR_VALUES_String
Attributes=AMX_GW_CLIENTID
Attributes=AMX_GW_ClientString
Attributes=AMX_AM_GW_MSISDNString
Attributes=AMX_GW_LoginNameString
Attributes=AMX_GW_SamlAuthnIdString
Attributes=AMX_GW_ACCESS_TOKEN
Attributes=AMX_GW_StartTimeLong
Attributes=AMX_GW_FinishTimeLong
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=!!!!!!!!!! ERROR IN SEND HTTP REQUEST !!!!!!!!!!


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/830.ErrorSentRequest/020.SetErrors]

AdornOps=copy GW_HTTPClientErrorCodeString GW_ErrorString
AdornOps=copy GW_HTTPClientErrorMessageString GW_ErrorDescriptionString
AdornOps=set AMX_GW_HttpStatusInteger 500
AdornOps=set AMX_GW_HttpErrorMesssage "Internal Server Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/830.ErrorSentRequest/030.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/840.ErrorInDB]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogError
RuleNames=020.SetErrors
RuleNames=030.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/840.ErrorInDB/010.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=!!!!!!!!!! ERROR IN Database !!!!!!!!!!


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/840.ErrorInDB/020.SetErrors]

AdornOps=set GW_ErrorString Internal Server Error
AdornOps=set GW_ErrorDescriptionString Error in data base 
AdornOps=set AMX_GW_HttpStatusInteger 500
AdornOps=set AMX_GW_HttpErrorMesssage "Internal Server Error"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/840.ErrorInDB/030.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/850.ErrorInvalidTokenID]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogError
RuleNames=020.SetErrors
RuleNames=030.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/850.ErrorInvalidTokenID/010.LogError]

Attributes=GW_HTTPClientErrorCodeString
Attributes=GW_HTTPClientErrorMessageString
Attributes=AMX_GW_USERID
Attributes=AMX_AM_GW_ACR_VALUES_String
Attributes=AMX_GW_CLIENTID
Attributes=AMX_GW_ClientString
Attributes=AMX_AM_GW_MSISDNString
Attributes=AMX_GW_LoginNameString
Attributes=AMX_GW_SamlAuthnIdString
Attributes=AMX_GW_ACCESS_TOKEN
Attributes=AMX_GW_StartTimeLong
Attributes=AMX_GW_FinishTimeLong
ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=ERROR
Message=::::::  Error TokenID not exist ::::::::::


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/850.ErrorInvalidTokenID/020.SetErrors]

AdornOps=set GW_ErrorString "200"
AdornOps=set  GW_ErrorDescriptionString "TokenID not exist"
AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set AMX_GW_HttpErrorMesssage "TokenId not exist"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/850.ErrorInvalidTokenID/030.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/860.ErrorUserInfoLookup]

ClassName=com.hp.siu.collector.rules.RuleChain
RuleNames=010.LogError
RuleNames=020.SetErrors
RuleNames=025.EncodeParameters
RuleNames=030.ResponseToClient


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/860.ErrorUserInfoLookup/010.LogError]

ClassName=com.hp.siu.collector.rules.LogNMERule
LogLevel=DEBUG
Message=[[[ ERROR in LOOCKUP IN USERINFO ]]]]


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/860.ErrorUserInfoLookup/020.SetErrors]

AdornOps=set GW_ErrorString Session Not Found
AdornOps=set GW_ErrorDescriptionString Session Not Found
AdornOps=set AMX_GW_HttpStatusInteger 200
AdornOps=set AMX_AM_GW_ResponseHandlerString "UserInfoResponseHandler"
ClassName=com.hp.siu.collector.rules.AdornmentRule


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/860.ErrorUserInfoLookup/025.EncodeParameters]

ClassName=com.hp.usage.nme.rules.NMEConversionRule
CreateSNMEIfNeeded=true
NMEToStructuredNMEMap=GW_ErrorString,error.CData
NMEToStructuredNMEMap=GW_ErrorDescriptionString,error_description.CData
SNMEType=SSO_CORP:ResponseUserInfo


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/RuleChains/860.ErrorUserInfoLookup/030.ResponseToClient]

ClassName=com.hp.siu.sessionserver.rules.LocalRuleChainInvoker
RuleChain=020.ResponseClient
UseRuleChainManagerPool=true


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/SessionStores]

ClassName=com.hp.siu.sessionserver.SessionStoreManager
SessionStoreNames=GatewayExtSession


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/SessionStores/GatewayExtSession]

ActiveSessionsThreshold=1000000
Attributes=AMX_GW_USERID,key
Attributes=AMX_GW_SESSIONID
Attributes=AMX_GW_CLIENTID
Attributes=AMX_GW_CLIENT_ID_ISSUER
Attributes=AMX_GW_LOGINNAME
Attributes=AMX_GW_CODE
Attributes=AMX_GW_STATE
Attributes=AMX_GW_ACCESS_TOKEN
Attributes=AMX_GW_REFRESH_TOKEN
Attributes=AMX_GW_NONCE
Attributes=AMX_GW_ENDTIMETOKENID
Attributes=AMX_GW_CONTEXT
Attributes=AMX_GW_SESSIONINFO
Attributes=AMX_GW_SAMLAUTHNID
Attributes=AMX_GW_SAMLASSERTION
Attributes=AMX_GW_STARTTIME
Attributes=AMX_GW_ENDTIME
ClassName=com.hp.siu.sessionserver.JDBCSessionStore
ConnectionPoolID=Pool1
DatabaseId=GW_EXTENSION_SESSIONS
IndexKeys=AMX_GW_SESSIONID
NativeConditions=ByAuthnId
NativeConditions=BySessionID
NativeConditions=ByAccessToken
SQLTypeMap=AMX_GW_USERID,VARCHAR2(50)
SQLTypeMap=AMX_GW_STARTTIME,NUMBER(19)
SQLTypeMap=AMX_GW_ENDTIME,NUMBER(19)
SQLTypeMap=AMX_GW_SESSIONINFO,RAW(20000)
SQLTypeMap=AMX_GW_SAMLASSERTION,RAW(20000)
SQLTypeMap=AMX_GW_ACCESS_TOKEN,VARCHAR2(255)


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/SessionStores/GatewayExtSession/ByAccessToken]

Condition=where AMX_GW_ACCESS_TOKEN=%AMX_GW_ACCESS_TOKEN and  AMX_GW_CLIENT_ID_ISSUER=%AMX_GW_CLIENT_ID_ISSUER


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/SessionStores/GatewayExtSession/ByAuthnId]

Condition=where AMX_GW_USERID=%AMX_GW_USERID


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/SessionStores/GatewayExtSession/BySessionID]

Condition=where AMX_GW_SESSIONID=%AMX_GW_SESSIONID and  AMX_GW_CLIENT_ID_ISSUER=%AMX_GW_CLIENT_ID_ISSUER


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/SnmeLoader]

ClassName=com.hp.usage.nme.schemaloader.NMESchemaLoader
Schema=SnmeSchemaLink


#END#
[/templates/CORPORATIVOS/OID/GW_TEMPLATE/SnmeLoader/SnmeSchemaLink]

Link=/SNMESchema
